% !TEX encoding = UTF-8
% !TEX program = pdflatex
% !TeX spellcheck = en_GB
% !BIB = biber


\documentclass[english]{article}
\usepackage{babel}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\graphicspath{{./images/}}
\usepackage{hyperref}
\usepackage{csquotes}
\hypersetup{
    colorlinks=true, 
	linkcolor=blue, 
	filecolor=blue, 
	citecolor = black,       
	urlcolor=blue, 
}

\usepackage{tcolorbox}
\usepackage{biblatex}
\addbibresource{bib.bib}

\title{5G Security}
\author{Alessandro Castelli \\ ID:\@147073 \\ E-mail: castelli.alessandro@spes.uniud.it}

\begin{document}

\maketitle

\begin{abstract}
	In recent decades, wireless communications have undergone rapid evolution,
	driven by the growing demand from users for faster, more reliable, and
	high-performance connections. Among the most significant technological
	innovations, 5G technology has emerged as the new frontier in mobile
	telecommunications, promising greater bandwidth capacity, lower latency,
	and an enormous density of connections for smart devices and IoT. However,
	along with these extraordinary capabilities, new security challenges also
	arise. 5G introduces a more complex and decentralized network infrastructure,
	increasing the risk of vulnerabilities and cyberattacks. This article examines
	the key aspects of 5G security, highlighting network vulnerabilities and
	discussing advanced technological solutions developed to mitigate these risks.
	% Negli ultimi decenni, le comunicazioni wireless hanno subito una rapida
	% evoluzione, alimentata dalla crescente domanda degli utenti per connessioni
	% sempre più veloci, affidabili e performanti. Tra le innovazioni tecnologiche
	% più rilevanti, la tecnologia 5G si è affermata come la nuova frontiera delle
	% telecomunicazioni mobili, promettendo una capacità di banda superiore,
	% latenze ridotte e una enorme densità di connessioni per dispositivi
	% intelligenti e IoT. Tuttavia, insieme a queste straordinarie capacità,
	% emergono anche nuove sfide in termini di sicurezza. Il 5G introduce una
	% infrastruttura di rete più complessa e decentralizzata, aumentando il rischio
	% di vulnerabilità e attacchi informatici. Questo articolo esamina i principali
	% aspetti della sicurezza del 5G, evidenziando le vulnerabilità della rete e
	% discutendo le soluzioni tecnologiche avanzate sviluppate per mitigare i rischi.
\end{abstract}

\clearpage

\tableofcontents
\newpage
\section{Introduzione}
The history of mobile communication is a journey of continuous innovation. It
all began with 1G~\cite{dangi2021study} in the 1970s and 1980s when data
transmission was analog. It was the beginning, but with significant
limitations: the quality was low, security was non-existent, and calls could be
easily intercepted. However, it enabled something revolutionary for that time:
mobile connectivity and the first voice services, albeit in a rudimentary form.
% La storia della comunicazione mobile è un viaggio di innovazione continua.
% Tutto inizia con il 1G~\cite{dangi2021study}, negli anni '70 e '80, quando la
% trasmissione dei dati era analogica. Era l'inizio, ma con grandi limiti: la
% qualità era bassa, la sicurezza inesistente e le chiamate potevano essere
% facilmente intercettate. Tuttavia, consentiva qualcosa di rivoluzionario per
% l'epoca: la connettività mobile e i primi servizi vocali, anche se in modo
% rudimentale.

With the arrival of 2G in 1991, the situation changed drastically.
Communication became digital, addressing many of the issues of 1G. Now there
was greater security, efficiency, and increased bandwidth. This opened the door
to new services such as text messaging, making mobile communication more
sophisticated.
% Con l'arrivo del 2G nel 1991, la situazione cambiò drasticamente. La
% comunicazione diventò digitale, affrontando molti dei problemi del 1G. Ora
% c'era più sicurezza, efficienza e una maggiore larghezza di banda. Si aprirono
% così le porte a nuovi servizi come i messaggi di testo, rendendo la
% comunicazione mobile più sofisticata.

Subsequently, 3G introduced the concept of mobile broadband. It was no longer
just about calls or messages, but also about video calls, internet browsing,
and much faster data transmission. 3G represented a breakthrough, although it
still suffered from spectrum and latency issues, demonstrating that the
technology still had room for improvement.
% Successivamente, il 3G introdusse il concetto di banda larga mobile. Non era
% più solo una questione di chiamate o messaggi, ma anche di videochiamate,
% navigazione su Internet e una trasmissione dati molto più veloce. Il 3G
% rappresentava una svolta, anche se soffriva ancora di problemi legati allo
% spettro e alla latenza, dimostrando che la tecnologia aveva ancora margini di
% miglioramento.

When 4G arrived between 2009 and 2010, the world of mobile communication made a
tremendous leap forward. Thanks to technologies like LTE, data speeds increased
significantly, bringing mobile streaming, online gaming, and high-definition
videos within reach anywhere. Theoretical download speeds could reach up to 100
Mbps, although in practice they were often lower.
% Quando arrivò il 4G, tra il 2009 e il 2010, il mondo della comunicazione mobile
% fece un enorme balzo in avanti. Grazie a tecnologie come LTE, la velocità dei
% dati aumentò significativamente, portando il mobile streaming, i giochi online
% e i video in alta definizione a portata di mano ovunque. Le velocità di
% download teoriche potevano raggiungere i 100 Mbps, sebbene nella pratica
% fossero spesso inferiori.

Finally, with the advent of 5G, we entered a new era. It was no longer just
about incremental improvements but about a revolution. 5G promises speeds of up
to 20 Gbps~\cite{javid20225g}, ultra-low latency, and the ability to connect
billions of devices simultaneously. It is a technology designed for an
interconnected world, where there are not only smartphones but also cars, IoT
devices, smart cities, and automated industrial systems. 5G is the foundation
of what will be the Internet of Everything, where every aspect of daily life is
connected and integrated into a global network.
% Infine, con l'avvento del 5G, si entrò in una nuova era. Non si parlava più
% solo di miglioramenti incrementali, ma di una rivoluzione. Il 5G promette
% velocità fino a 20 Gbps~\cite{javid20225g}, una latenza ultra bassa e la
% capacità di connettere miliardi di dispositivi contemporaneamente. È una
% tecnologia pensata per un mondo interconnesso, dove non ci sono solo
% smartphone, ma anche automobili, dispositivi IoT, smart cities e sistemi
% industriali automatizzati. Il 5G è il fondamento di quella che sarà l'Internet
% of Everything, dove ogni aspetto della vita quotidiana è connesso e integrato
% in una rete globale.

Il \textbf{5G} thus represents the latest evolution in mobile communication
technology, bringing significant improvements such as \textit{high bandwidth}
and \textit{extremely low latency}. This technology supports advanced
applications like augmented reality (AR), virtual reality (VR), and
ultra-reliable low-latency communications (URLLC). In March 2018, the
\href{https://www.3gpp.org/technologies/5g-system-overview}{3GPP} released the
15th version of the mobile communication standards, laying the groundwork for
the \textbf{5G}. The transmission speed of this new technology allows users to
enjoy significantly higher data transfers, particularly for applications that
require high throughput, such as high-definition video
streaming~\cite{javid20225g}.
% Il \textbf{5G} rappresenta quindi l'ultima evoluzione nella tecnologia di
% comunicazione mobile, portando miglioramenti significativi come
% \textit{larghezza di banda elevata} e \textit{latenza estremamente bassa}.
% Questa tecnologia supporta applicazioni avanzate come la realtà aumentata (AR),
% la realtà virtuale (VR) e le comunicazioni ultra-affidabili a bassa latenza
% (URLLC). Nel marzo 2018, il
% \href{https://www.3gpp.org/technologies/5g-system-overview}{3GPP} ha rilasciato
% la 15ª release degli standard di comunicazione mobile, stabilendo le basi per
% il \textbf{5G}. La velocità di trasmissione di questa nuova tecnologia consente
% agli utenti di usufruire di trasferimenti dati notevolmente superiori, in
% particolare per applicazioni che richiedono un alto throughput, come lo
% streaming video in alta definizione~\cite{javid20225g}.

The reduction of latency is another key goal, with the expectation of latency
lower than 1 millisecond, paving the way for real-time use of critical
applications such as telemedicine and autonomous driving. Moreover, 5G enables
the simultaneous connection of a much larger number of devices compared to
previous generations, a fundamental feature given the continuous growth of the
IoT market.
% La riduzione della latenza è un altro obiettivo chiave, con la previsione di
% una latenza inferiore a 1 millisecondo, aprendo la strada all'uso in tempo
% reale di applicazioni critiche come la telemedicina e la guida autonoma.
% Inoltre, il 5G permette la connessione simultanea di un numero molto maggiore
% di dispositivi rispetto alle generazioni precedenti, una caratteristica
% fondamentale vista la continua crescita del mercato IoT.

Thanks to all this, 5G will become a foundation for a network that connects not
only people but also objects, devices, and machines. We are talking, therefore,
about a system that is revolutionizing the way we envision the internet—not
merely as an exchange of data between people, but as a massive integration
between humans and machines, and among machines themselves.
% Grazie a tutto questo, il 5G diventerà una base per una rete che connette non
% solo persone, ma anche oggetti, dispositivi e macchine. Si sta parlando,
% quindi, di un sistema che sta rivoluzionando il modo in cui immaginiamo
% internet, non più solo come uno scambio di dati tra persone, ma come
% un'integrazione massiccia tra esseri umani e macchine, e tra macchine stesse.

And here come into play the three fundamental scenarios of 5G: \textbf{eMBB,
	mMTC,} and \textbf{uRLLC}. Each of these represents a facet of the overall
vision of 5G~\cite{Ji2018Overview}: \textbf{eMBB} is designed for enhanced
mobile broadband, allowing for ultra-fast downloads and high-quality streaming;
\textbf{mMTC} focuses on massive machine-type communication, essential for
supporting the IoT (Internet of Things); while \textbf{uRLLC} is crucial for
applications requiring minimal latency and extreme reliability, such as
tele-surgery or autonomous vehicles. But what are the technologies that
actually make all this possible? \\ \sloppy The 3GPP has defined more than 70
types of 5G SA1 files necessary for this purpose, and the key technologies
developed for 5G include: \textit{\hyperlink{MIMO}{Massive MIMO}},
\textit{\hyperlink{FBMC}{filter bank based multicarrier (FBMC)}},
\textit{\hyperlink{FullDuplex}{Full Duplex}}, \textit{\hyperlink{UDN}{Ultra
		Dense networking (UDN)}}, \textit{\hyperlink{SDN}{software-defined networking
		(SDN)}}, and \textit{\hyperlink{NFV}{network function virtualization
		(NFV)}}~\cite{Ji2018Overview}. \\ This article will present an in-depth study
on security within 5G networks. Section~\ref{sec:ThreatModel} will examine the
assets, attackers, and risks associated with a 5G network.
Section~\ref{sec:SecurityGoal} will outline the security objectives intended to
be achieved for the identified assets. Section~\ref{sec:4} will analyze the
security services implemented within this technology. Finally,
Section~\ref{sec:5} will discuss the potential vulnerabilities present. To keep
the text clear and concise, avoiding excessive complications and frequent
digressions into the various technologies and vulnerabilities, a glossary has
been included at the end of the document. This glossary provides explanations
of protocols, acronyms, and other relevant terms, thereby facilitating the
understanding of the content.
% E qui entrano in gioco i tre scenari fondamentali del 5G:\@ \textbf{eMBB, mMTC
% 	e uRLLC}. Ognuno di questi rappresenta una sfaccettatura dell'intera visione
% del 5G~\cite{Ji2018Overview}: \textbf{eMBB} è pensato per una banda larga
% mobile potenziata, consentendo download rapidissimi e streaming ad altissima
% qualità; \textbf{mMTC} è rivolto alla comunicazione massiva tra macchine,
% essenziale per supportare l’IoT (Internet of Things); \textbf{uRLLC} invece è
% cruciale per applicazioni che richiedono una latenza minima e un'affidabilità
% estrema, come la telechirurgia o i veicoli autonomi. Ma quali sono le
% tecnologie che effettivamente rendono possibile tutto questo? \\ \sloppy Il
% 3GPP ha definito più di 70 tipi di file 5G SA1 necessari a questo scopo, e le
% tecnologie chiave sviluppate per il 5G includono:
% \textit{\hyperlink{MIMO}{Massive MIMO}}, \textit{\hyperlink{FBMC}{filter bank
% 		based multicarrier (FBMC)}}, \textit{\hyperlink{FullDuplex}{Full Duplex}},
% \textit{\hyperlink{UDN}{Ultra Dense networking (UDN)}},
% \textit{\hyperlink{SDN}{software-defined networking (SDN)}} e
% \textit{\hyperlink{NFV}{network function virtualization
% 		(NFV)}}~\cite{Ji2018Overview}. \\ In questo articolo verrà presentato uno
% studio approfondito sulla sicurezza all'interno delle reti 5G. Nella
% Sezione~\ref{sec:ThreatModel} si esamineranno gli asset, gli attaccanti e i
% rischi associati a una rete 5G. La Sezione~\ref{sec:SecurityGoal} illustrerà
% gli obiettivi di sicurezza che si intendono raggiungere per gli asset
% identificati. Nella Sezione~\ref{sec:4} verranno analizzati i servizi di
% sicurezza implementati all'interno di questa tecnologia. Infine, nella
% Sezione~\ref{sec:5} si discuteranno le potenziali vulnerabilità presenti. Per
% mantenere il testo chiaro e conciso, evitando complicazioni eccessive e
% approfondimenti frequenti sulle diverse tecnologie e vulnerabilità, alla fine
% del documento è stato inserito un glossario. Questo glossario fornisce
% spiegazioni sui protocolli, sulle sigle e su altri termini pertinenti,
% facilitando così la comprensione del contenuto.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
\section{Threat model}\label{sec:ThreatModel}
In the literature, numerous security challenges related to 5G have been
identified. The main assets involved include sensitive user data, such as
personal information and browsing data, which transit through the 5G network.
In addition, there is the network infrastructure itself, composed of base
stations, servers, and networking devices, as well as end-user devices,
including smartphones, tablets, and IoT devices, which represent an essential
part of the system. It is important to note that, in addition to end devices,
the network control systems responsible for traffic management and
authentication require adequate protection to ensure the integrity and
availability of the network.
% In letteratura sono state identificate numerose sfide legate alla sicurezza del
% 5G. Gli asset principali coinvolti includono i dati sensibili degli utenti,
% come informazioni personali e dati di navigazione, che transitano attraverso la
% rete 5G. A questo si aggiungono l'infrastruttura di rete stessa, composta da
% stazioni base, server e dispositivi di rete, nonché i dispositivi degli utenti
% finali, tra cui smartphone, tablet e dispositivi IoT, che rappresentano una
% parte essenziale del sistema. È importante notare che, oltre ai dispositivi
% finali, i sistemi di controllo della rete, incaricati della gestione del
% traffico e dell'autenticazione, necessitano di una protezione adeguata per
% garantire l'integrità e la disponibilità della rete.

5G networks introduce various innovative technologies, such as
\textit{\hyperlink{SDN}{software-defined networking (SDN)}} and
\textit{\hyperlink{NFV}{network function virtualization (NFV)}},
which offer significant advantages in terms of flexibility and
scalability. However, these technologies also expose the network
to new security risks, such as resource exhaustion and vulnerabilities
in programming interfaces, which can become targets for targeted attacks.
Additionally, \textit{\hyperlink{MIMO}{Massive Multiple-Input Multiple-Output (MIMO)}}
and \textit{\hyperlink{mmWave}{millimeter-wave communications (mmWave)}}
increase network capacity, but they must address security issues related to
resource management and information confidentiality. Cloud computing and
\textit{Multi-access Edge Computing} (MEC) can also contribute to improving
network efficiency, but the storage and processing of data in the cloud increase
the risk of attacks on sensitive data~\cite{Ahmad2019Security}.
% Le reti 5G introducono diverse tecnologie innovative, come il
% \textit{\hyperlink{SDN}{software-defined networking (SDN)}} e il
% \textit{\hyperlink{NFV}{network function virtualization (NFV)}}, che offrono
% vantaggi significativi in termini di flessibilità e scalabilità. Tuttavia,
% queste tecnologie espongono anche la rete a nuovi rischi di sicurezza, come
% l'esaurimento delle risorse e vulnerabilità nelle interfacce di programmazione,
% che possono diventare obiettivi per attacchi mirati. Inoltre, il
% \textit{\hyperlink{MIMO}{Massive Multiple-Input Multiple-Output (MIMO)}} e le
% \textit{\hyperlink{mmWave}{comunicazioni a onde millimetriche (mmWave)}}
% aumentano la capacità delle reti, ma devono affrontare problemi di sicurezza
% legati alla gestione delle risorse e alla segretezza delle informazioni. Anche
% il \textit{cloud computing} e il \textit{Multi-access Edge Computing} (MEC)
% possono contribuire a migliorare l'efficienza della rete, ma l'archiviazione e
% l'elaborazione dei dati nel cloud aumentano il rischio di attacchi ai dati
% sensibili~\cite{Ahmad2019Security}.

The potential attackers in this context can vary significantly. On one hand,
there are individual hackers seeking to intercept or manipulate data for
illicit purposes. On the other hand, there are organized cyber-criminal groups,
and in some cases, even state-sponsored actors, whose objective might be to
gain unauthorized access to sensitive information or cause damage to the
network for economic or geopolitical reasons. Adding complexity to the picture
are also internal malicious actors, meaning personnel with legitimate access to
the network, who could abuse their permissions. In this context, it is crucial
to recognize that vulnerabilities do not only come from the outside, but also
from misconfigurations and inadequate security practices by authorized
personnel. The attack vectors through which these actors can strike are
numerous. The security of radio interfaces could be compromised if such
protocols are not implemented correctly or if complex vulnerabilities are
exploited. This paves the way for attacks such as communication interception or
classic man-in-the-middle attacks. The integrity of the user plane also
represents a critical point: despite the introduction of advanced encryption in
5G, targeted attacks could exploit any flaws in the data protection process,
thereby compromising the integrity of the transmitted data without being
detected.
% I potenziali attaccanti in questo contesto possono variare notevolmente. Da una
% parte, ci sono hacker individuali che cercano di intercettare o manipolare i
% dati per scopi illeciti. Dall'altra, vi sono gruppi di cyber-criminali
% organizzati, e in alcuni casi anche attori sponsorizzati da stati, il cui
% obiettivo potrebbe essere ottenere accesso non autorizzato a informazioni
% sensibili o causare danni alla rete per ragioni economiche o geopolitiche. A
% rendere più complesso il quadro ci sono anche malintenzionati interni, ovvero
% personale con accesso legittimo alla rete, che potrebbe abusare delle proprie
% autorizzazioni. In questo contesto, è cruciale riconoscere che le vulnerabilità
% non provengono solo dall'esterno, ma anche da configurazioni errate e pratiche
% di sicurezza inadeguate da parte del personale autorizzato. I vettori di
% attacco attraverso cui questi attori possono colpire sono molteplici. La
% sicurezza delle interfacce radio, potrebbe essere compromessa se tali
% protocolli non vengono implementati correttamente o se si sfruttano
% vulnerabilità complesse. Questo apre la strada ad attacchi come
% l'intercettazione delle comunicazioni o i classici man-in-the-middle. Anche
% l'integrità del piano utente rappresenta un punto critico: nonostante
% l'introduzione di crittografia avanzata nel 5G, attacchi mirati potrebbero
% sfruttare eventuali falle nel processo di protezione dei dati, compromettendo
% così l'integrità dei dati trasmessi senza essere rilevati.

During roaming, another critical moment for security, the protection parameters
of users may not be updated correctly when transitioning between different
networks, exposing users to potential data interception or manipulation
attacks. This issue highlights the need for proper synchronization and updating
of security measures across different networks to ensure continuous and
consistent protection.
% Durante il roaming, un altro momento delicato per la sicurezza, i parametri di
% protezione degli utenti potrebbero non essere aggiornati correttamente al
% passaggio tra reti diverse, esponendo gli utenti a potenziali attacchi di
% intercettazione o manipolazione dei dati. Questa problematica evidenzia la
% necessità di un'adeguata sincronizzazione e aggiornamento delle misure di
% sicurezza tra diverse reti, al fine di garantire una protezione continua e
% coerente.

The 5G infrastructure is also not immune to DoS (Denial of Service) attacks.
Despite advances in protective measures, the network control systems remain
visible and can be vulnerable to service disruptions, especially if the control
channels are not adequately encrypted. Here, the management of credentials and
configurations becomes essential to prevent unauthorized access.
% L'infrastruttura del 5G, inoltre, non è immune da attacchi DoS (Denial of
% Service). Nonostante i progressi nelle misure di protezione, i sistemi di
% controllo della rete rimangono visibili e possono essere vulnerabili a
% interruzioni del servizio, soprattutto se i canali di controllo non sono
% crittografati adeguatamente. Qui, la gestione delle credenziali e delle
% configurazioni diventa fondamentale per prevenire accessi non autorizzati.

Finally, an important attack vector is represented by end-user devices. Often,
these devices lack sufficient security measures at the operating system and
application level, making them vulnerable to malware, DoS attacks, or
manipulation of configuration data, thereby compromising the entire network.
This vulnerability is exacerbated by the increasing proliferation of IoT
devices, which may have intrinsic vulnerabilities due to inadequate designs or
a lack of regular updates.
% Infine, un importante vettore di attacco è rappresentato dai dispositivi degli
% utenti finali. Spesso, questi dispositivi non sono dotati di misure di
% sicurezza sufficienti a livello di sistema operativo e applicazioni, rendendoli
% vulnerabili a malware, attacchi DoS o manipolazioni dei dati di configurazione,
% compromettendo così l'intera rete. Questa vulnerabilità è accentuata dalla
% crescente diffusione dei dispositivi IoT, che possono presentare vulnerabilità
% intrinseche dovute a progettazioni inadeguate o a una mancanza di aggiornamenti
% regolari.

In conclusion, the threat landscape in the 5G network is complex and varied,
requiring a multifactorial approach for asset protection and risk mitigation.
Special attention must be paid not only to security technologies and protocols
but also to the continuous training of personnel and the awareness of end-users
regarding risks and best practices for security.
% In conclusione, il panorama delle minacce nella rete 5G è complesso e
% variegato, richiedendo un approccio multifattoriale per la protezione degli
% asset e la mitigazione dei rischi. Un'attenzione particolare deve essere
% dedicata non solo alle tecnologie e ai protocolli di sicurezza, ma anche alla
% formazione continua del personale e alla consapevolezza degli utenti finali
% riguardo ai rischi e alle migliori pratiche per la sicurezza.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Security goals}\label{sec:SecurityGoal}
Every communication system, in order to be considered secure, needs protection
protocols and technologies that safeguard the resources used in communication,
ensuring that the data complies with the properties of:
\textbf{Confidentiality}, \textbf{Integrity}, \textbf{Availability},
\textbf{Authenticity}, \textbf{Accountability}~\cite{mohan2022cyber}.
% Ogni sistema di comunicazione affinchè sia considerato sicuro ha bisogno di
% protocolli e tecnolgie di protezione che proteggano le risorse usate la
% comunizazione in modo tale da garantire che i dati rispettino le proprietà di:
% \textbf{Riservatezza}, \textbf{Integrità}, \textbf{Disponibilità},
% \textbf{Autenticità, \textbf{Accountability}}~\cite{mohan2022cyber}.

These objectives are essential to ensure that 5G networks can operate securely
and reliably, protecting users' data and communications. Let’s start with
Confidentiality. This objective aims to ensure that only authorized users can
access sensitive information. In 5G networks, where the volume of transmitted
data is enormous and includes personal and business information, it is crucial
to implement robust encryption and authentication measures. Confidentiality is
not just a matter of data protection, but also of users' trust in the system.
If users perceive that their data is not secure, they may be reluctant to use
the services offered.
% Questi obiettivi sono essenziali per garantire che le reti 5G possano operare
% in modo sicuro e affidabile, proteggendo i dati e le comunicazioni degli
% utenti. Iniziamo con la Riservatezza. Questo obiettivo mira a garantire che
% solo gli utenti autorizzati possano accedere alle informazioni sensibili. Nelle
% reti 5G, dove la quantità di dati trasmessi è enorme e include informazioni
% personali e aziendali, è cruciale implementare misure di crittografia e
% autenticazione robusta. La riservatezza non è solo una questione di protezione
% dei dati, ma anche di fiducia degli utenti nel sistema. Se gli utenti
% percepiscono che i loro dati non sono al sicuro, potrebbero essere riluttanti a
% utilizzare i servizi offerti.

Moving on to Integrity, this objective focuses on protecting data from
unauthorized modifications. In a 5G environment, where IoT devices and critical
applications are increasingly interconnected, it is essential to ensure that
information remains accurate and is not altered during transmission.
% Passando all'Integrità, questo obiettivo si
% concentra sulla protezione dei dati da modifiche non autorizzate. In un
% ambiente 5G, dove i dispositivi IoT e le applicazioni critiche sono sempre più
% interconnessi, è fondamentale garantire che le informazioni rimangano accurate
% e non vengano alterate durante la trasmissione.  

\textbf{Availability} is another key objective. 5G networks must be always
available to ensure that users can access services at any time. This is
particularly important for critical applications such as those in the healthcare
or transportation sectors. To achieve this objective, it is necessary to implement
redundancy and resilience solutions to mitigate the effects of attacks such as
Distributed Denial of Service (DDoS), which can compromise the availability of services.
% La Disponibilità è un altro obiettivo chiave. Le reti 5G devono essere sempre
% disponibili per garantire che gli utenti possano accedere ai servizi in
% qualsiasi momento. Questo è particolarmente importante per applicazioni
% critiche come quelle nel settore sanitario o nei trasporti. Per raggiungere
% questo obiettivo, è necessario implementare soluzioni di ridondanza e
% resilienza, in modo da mitigare gli effetti di attacchi come i Distributed
% Denial of Service (DDoS), che possono compromettere la disponibilità dei
% servizi.

\textbf{Authenticity} is essential to ensure that the entities involved in
communications are who they claim to be. In a 5G context, where interactions
occur between a variety of devices and users, it is crucial to implement robust
authentication mechanisms. This not only protects assets from unauthorized
access but also helps to build a trust ecosystem among the various actors involved.
% L'Autenticità è fondamentale per garantire che le entità coinvolte nelle
% comunicazioni siano chi dichiarano di essere. In un contesto 5G, dove le
% interazioni avvengono tra una varietà di dispositivi e utenti, è essenziale
% implementare meccanismi di autenticazione robusti. Ciò non solo protegge gli
% asset da accessi non autorizzati, ma contribuisce anche a costruire un
% ecosistema di fiducia tra i vari attori coinvolti. 

Finally, \textbf{Accountability} is crucial to ensure that all actions and
transactions within the network can be traced and verified. This objective is
particularly important for regulatory compliance and for managing
responsibilities. Implementing logging and monitoring systems allows for the
detection of suspicious activities and enables a rapid response to potential
security incidents.
% Infine, la Accountability è cruciale per garantire che tutte le azioni e le
% transazioni all'interno della rete possano essere tracciate e verificate.
% Questo obiettivo è particolarmente importante per la conformità alle normative
% e per la gestione delle responsabilità. Implementare sistemi di logging e
% monitoraggio consente di rilevare attività sospette e di rispondere rapidamente
% a potenziali incidenti di sicurezza. 

In summary, the CIAAA model provides a comprehensive framework for addressing
security challenges in 5G networks. Each objective is interconnected and
contributes to creating a secure and reliable environment for users and
applications. Protecting assets in a 5G context requires a holistic approach
that integrates advanced technologies, strict security policies, and continuous
vigilance to address emerging threats.
% In sintesi, il modello CIAAA fornisce un framework completo per affrontare le
% sfide di sicurezza nelle reti 5G. Ogni obiettivo è interconnesso e contribuisce
% a creare un ambiente sicuro e affidabile per gli utenti e le applicazioni. La
% protezione degli asset in un contesto 5G richiede un approccio olistico che
% integri tecnologie avanzate, politiche di sicurezza rigorose e una continua
% vigilanza per affrontare le minacce emergenti.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Security service and implementation}\label{sec:4}
The architecture of 5G is organized into 3 layers: an application layer, a
service layer, and a transport layer~\cite{Jover2018Security}. Each layer is
designed with specific security functionalities that, when combined, create a
secure and resilient system against threats. The main security elements in 5G
include:
% L'architettura del 5G è organizzata attraverso 3 strati: uno strato applicatvo,
% uno strato di servizio e uno strato di trasporto~\cite{Jover2018Security}. Ogni
% strato è progettato con specifiche funzionalità di sicurezza che, combinate tra
% loro, creano un sistema sicuro e resistente alle minacce. I principali elementi
% di sicurezza nel 5G includono:

\begin{itemize}
	\item \textbf{Network access security}:
	      Mechanisms that allow a user device (UE) to authenticate and securely
	      access network services. The UE exchanges protocol messages through
	      the access network with the service network (SN). Cryptographic keys
	      are stored in the \texttt{USIM} module of the device and in the operator's
	      environment. This ensures the security of data and communications,
	      preventing unauthorized access.
	      % \item \textbf{Sicurezza dell'accesso alla rete}: Meccanismi che permettono a
	      %       un dispositivo utente (UE) di autenticarsi e accedere in modo sicuro ai
	      %       servizi di rete. L'UE scambia messaggi di protocollo attraverso la rete di accesso
	      %       con la rete di servizio (SN).
	      %       Le chiavi crittografiche sono memorizzate nel modulo \texttt{USIM} del dispositivo e nell'ambiente
	      %       dell'operatore. Questo garantisce la sicurezza dei dati e delle comunicazioni,
	      %       impedendo accessi non autorizzati.
	\item \textbf{Network domain security}:
	      A set of features that enable network nodes to securely exchange
	      control plane and user plane data within 3GPP networks and across
	      different networks. Protection techniques include encryption and
	      integrity measures to prevent interception and tampering.
	      % \item \textbf{Sicurezza del dominio di rete}: Un insieme di caratteristiche che permettono
	      %       ai nodi della rete di scambiarsi in modo sicuro i dati del piano di controllo e del piano
	      %       utente all'interno delle reti 3GPP e tra reti diverse. Le tecniche di protezione includono
	      %       crittografia e integrità per evitare intercettazioni e manomissioni.
	\item \textbf{User domain security}:
	      Focuses on protecting the user's device and the data contained
	      within it, preventing unauthorized access to the mobile terminal.
	      Hardware mechanisms are implemented to protect the \texttt{USIM} module
	      and prevent tampering with terminals, ensuring user authenticity.
	      % \item \textbf{Sicurezza del dominio utente}: Si concentra sulla protezione del dispositivo
	      %       dell'utente e dei dati contenuti, impedendo l'accesso non autorizzato al terminale mobile.
	      %       Sono implementati meccanismi hardware per proteggere il modulo   \texttt{USIM} e prevenire la
	      %       manomissione dei terminali, garantendo l'autenticità dell'utente.
	\item \textbf{Service-based architecture domain security}:
	      Protects the registration, discovery, and authorization of
	      network elements, as well as service-based interfaces.
	      It enables the secure integration of new virtual network
	      functions in 5G and supports secure roaming,
	      involving both the service network and the home network.
	      % \item \textbf{Sicurezza del dominio dell'architettura basata su servizi}: Protegge la
	      %       registrazione, la scoperta e l'autorizzazione degli elementi di rete, nonché le interfacce
	      %       basate su servizi. Consente l'integrazione sicura delle nuove funzioni di rete virtuali
	      %       del 5G, e supporta il roaming sicuro, coinvolgendo la rete di servizio
	      %       e la rete domestica.
	\item \textbf{Visibility and configurability of security}:
	      Allows users to be informed about the presence of security
	      functions and offers the possibility to configure security
	      features according to their needs. The security specifications
	      of 5G, defined by 3GPP, establish optional functionalities,
	      providing degrees of freedom for the secure implementation
	      and operation of the network.
	      % \item \textbf{Visibilità e configurabilità della sicurezza}: Consente agli utenti di essere
	      %       informati sulla presenza di funzioni di sicurezza e offre la possibilità di configurare le
	      %       caratteristiche di sicurezza in base alle esigenze. Le specifiche di sicurezza del 5G,
	      %       definite dal 3GPP, stabiliscono funzionalità opzionali, fornendo gradi di libertà per
	      %       l'implementazione e il funzionamento sicuro della rete.
\end{itemize}

The security procedures of 5G are based on a hierarchical derivation framework.
The long-term key \texttt{K} is stored by the \texttt{Authentication Credential
	Repository and Processing Function} (ARPF) while the USIM holds the
corresponding copy of that user symmetric key~\cite{Jover2018Security}. All
other keys are derived from it.
% Le procedure di sicurezza del 5G si basano su un framework a derivazione
% gerarchica. La chiave a lungo termine \texttt{K} è conservata dalla
% \texttt{Authentication Credential Repository and Processing Function} (ARPF)
% mentre la USIM conserva la copia corrispondente di tale chiave simmetrica
% dell'utente~\cite{Jover2018Security}. Tutte le altre chiavi sono derivate da
% essa. (per vedere come vengono generate le chiavi guarda 13).

The 3GPP introduced the \texttt{Extensible Authentication Protocol (EAP)} for
Authentication and Key Agreement, defining
\texttt{\hyperlink{EAP-AKA}{EAP-AKA}} and \texttt{\hyperlink{5G AKA}{5G AKA}}
as mandatory authentication methods for devices (UE) and the network. These
protocols ensure mutual authentication between the device and the network, as
well as protecting the security and encryption of services. During
registration, a 5G device sends the SUCI to initiate the authentication process
based on the selected protocol.
% Il 3GPP ha introdotto l'\texttt{Extensible Authentication Protocol (EAP)} per
% l'Autenticazione e l'Accordo delle Chiavi, definendo
% l'\texttt{\hyperlink{EAP-AKA}{EAP-AKA}} e il \texttt{\hyperlink{5G AKA}{5G
% 		AKA}} come metodi obbligatori di autenticazione per i dispositivi (UE) e la
% rete. Questi protocolli garantiscono un'autenticazione reciproca tra il
% dispositivo e la rete, oltre a proteggere la sicurezza e la cifratura dei
% servizi. Durante la registrazione, un dispositivo 5G invia il SUCI per avviare
% il processo di autenticazione basato sul protocollo selezionato.

The 5G security specifications define various security contexts for different
situations: for a single 5G service network (SN), between multiple SNs, and
between 5G and 4G networks. When a device is connected to two SNs, each network
must independently manage and utilize its own security context. In the case
where the device is registered on two SNs within the same Public Land Mobile
Network (\hyperlink{PLMN}{PLMN}), whether they are 3GPP or non-3GPP, the device
establishes two separate Non-Access Stratum (NAS) connections for each network,
but shares a common NAS security context, which includes a single set of keys
and security algorithms.
% Le specifiche di sicurezza del 5G definiscono vari contesti di sicurezza per
% diverse situazioni: per una singola rete di servizio 5G (SN), tra più SN e tra
% reti 5G e 4G. Quando un dispositivo è connesso a due SN, ciascuna rete deve
% gestire e utilizzare autonomamente un proprio contesto di sicurezza. Nel caso
% in cui il dispositivo sia registrato su due SN all'interno della stessa rete
% pubblica mobile terrestre (\hyperlink{PLMN}{PLMN}), che siano 3GPP o non-3GPP,
% il dispositivo stabilisce due connessioni NAS (Non-Access Stratum) separate per
% ciascuna rete, ma condivide un contesto di sicurezza NAS comune, che include un
% unico insieme di chiavi e algoritmi di sicurezza.

The procedures for maintaining or discarding a security context during state
transition state that the configuration of the handover type is at the
operator's discretion, based on individual security requirements. Consequently,
security during handover becomes an optional function rather than a mandatory
one, which may lead some operators to implement potentially insecure handover
procedures.
% Le procedure per mantenere o scartare un contesto di sicurezza durante la
% transizione di stato dicano che la configurazione della tipologia di handover è
% a discrezione dell'operatore, basandosi sui requisiti di sicurezza individuali.
% Di conseguenza, la sicurezza durante l'handover diventa una funzione opzionale
% e non obbligatoria, il che potrebbe portare alcuni operatori a implementare
% procedure di handover potenzialmente non sicure.

Cryptographic separation and protection against replay attacks for two active
NAS connections are ensured through a shared NAS security context, with
distinct parameters for each connection. The NAS employs 128-bit encryption
algorithms to ensure the integrity and confidentiality of the data. It is
important to note, however, that options for null encryption and integrity
protection are also provided. Additionally, if the device does not have a NAS
security context, the initial NAS message is transmitted in clear text,
including the subscriber identifier and the device's security capabilities.
% La separazione crittografica e la protezione contro attacchi di replay per due
% connessioni NAS attive vengono garantite attraverso un contesto di sicurezza
% NAS condiviso, con parametri distinti per ciascuna connessione. Il NAS impiega
% algoritmi di cifratura a 128 bit per garantire l'integrità e la riservatezza
% dei dati. È importante notare, tuttavia, che sono previste anche opzioni di
% cifratura e protezione dell'integrità nulle. Inoltre, se il dispositivo non
% dispone di un contesto di sicurezza NAS, il messaggio NAS iniziale viene
% trasmesso in chiaro, includendo l'identificatore dell'abbonato e le capacità di
% sicurezza del dispositivo stesso.

In the control of radio resources, integrity and confidentiality are ensured by
the PDCP (Packet Data Convergence Protocol) layer that operates between the
device and the \hyperlink{gNB}{gNB}. It is important to note that no layer
below the PDCP is subject to integrity protection. Protection against replay
attacks is activated when integrity protection is in function, except in cases
where null integrity protection is selected. RRC integrity checks are performed
both on the device and the \hyperlink{gNB}{gNB}, and if an integrity check
fails after protection has been activated, the corresponding message is
immediately discarded.
% Nel controllo delle risorse radio, l'integrità e la riservatezza vengono
% garantite dal livello PDCP (Packet Data Convergence Protocol) che opera tra il
% dispositivo e il \hyperlink{gNB}{gNB}.\@ È importante notare che nessun livello
% al di sotto del PDCP è soggetto a protezione dell'integrità. La protezione
% contro gli attacchi di replay è attivata quando la protezione dell'integrità è
% in funzione, tranne nel caso in cui sia selezionata la protezione
% dell'integrità nulla. I controlli di integrità RRC vengono effettuati sia sul
% dispositivo che sul \hyperlink{gNB}{gNB}, e se un controllo di integrità
% fallisce dopo che la protezione è stata attivata, il messaggio corrispondente
% viene immediatamente scartato.

Moving to the user plane, the Session Management Function (SMF) is responsible
for providing the security policy for a PDU (Protocol Data Unit) session to the
\hyperlink{gNB}{gNB} during the session establishment phase. If integrity
protection is not activated for the Data Radio Bearers (DRB), neither the
\hyperlink{gNB}{gNB} nor the device will be able to protect the integrity of
the traffic of such DRBs. Similarly, if user plane encryption is not activated
for the DRBs, the traffic will not be encrypted. The local SMF has the option
to override the confidentiality option present in the user plane security
policy received from the Home Network (HN) SMF.\@
% Passando al piano utente, la funzione di gestione delle sessioni (SMF) si
% occupa di fornire la politica di sicurezza per una sessione PDU (Protocol Data
% Unit) al \hyperlink{gNB}{gNB} durante la fase di stabilimento della sessione.
% Se la protezione dell'integrità non è attivata per i portatori radio di dati
% (DRB), né il \hyperlink{gNB}{gNB} né il dispositivo saranno in grado di
% proteggere l'integrità del traffico di tali DRB.\@ Allo stesso modo, se la
% cifratura del piano utente non è attivata per i DRB, il traffico non verrà
% cifrato. La SMF locale ha la possibilità di sovrascrivere l'opzione di
% riservatezza presente nella politica di sicurezza del piano utente ricevuta
% dalla SMF della rete di origine (HN).

Finally, regarding the privacy of the subscription ID, the SUCI represents the
concealed version of the permanent subscription identifier of 5G (SUPI). This
is transmitted over the air to avoid exposing the user's identity in clear
text. The SUCI is generated from the SUPI using the operator's public key and a
probabilistic asymmetric encryption method, which helps to prevent identity
tracking. However, the null protection system of the SUPI is used during
unauthenticated emergency sessions if configured by the Home Network (HN), or
when the operator's public key has not been provided. The 5G specifications
also define a temporary identifier, the 5G Globally Unique Temporary Identifier
(5G-GUTI), to reduce the exposure of the SUPI and the SUCI.\@ The 5G-GUTI must
be reassigned based on device triggers, but the frequency of such reassignment
is left to the discretion of the network implementation.
% Infine, per quanto riguarda la privacy dello ID di abbonamento, il SUCI
% rappresenta la versione nascosta dell'identificatore di abbonamento permanente
% del 5G (SUPI). Questo viene trasmesso via etere per evitare l'esposizione
% dell'identità dell'utente in chiaro. Il SUCI è generato dal SUPI utilizzando la
% chiave pubblica dell'operatore e un metodo di crittografia asimmetrica
% probabilistica, il quale aiuta a prevenire il tracciamento dell'identità.
% Tuttavia, il sistema di protezione nulla del SUPI è utilizzato durante sessioni
% d'emergenza non autenticate, se configurato dalla rete di origine (HN), oppure
% quando la chiave pubblica dell'operatore non è stata fornita. Le specifiche del
% 5G definiscono anche un identificatore temporaneo, il 5G Globally Unique
% Temporary Identifier (5G-GUTI), per ridurre l'esposizione del SUPI e del
% SUCI.\@ Il 5G-GUTI deve essere riassegnato in base ai trigger del dispositivo,
% ma la frequenza di tale riassegnazione è lasciata alla discrezione
% dell'implementazione della rete.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Attacks and Vulnerabilities}\label{sec:5}
In this section, the vulnerabilities present in 5G networks will be analyzed,
taking into account the differences related to the architectures used. 5G
networks can be divided into two main categories: the Non-Standalone 5G (NSA),
a transitional architecture that relies on 4G LTE infrastructure for signaling
and control management, and the Standalone 5G (SA), which represents a
completely autonomous network. It is essential to understand that
vulnerabilities can manifest in both architectures; however, some may be more
common or relevant in one than the other, depending on the specific
implementations and technologies used. Below, some of the main vulnerabilities
that can be easily exploited in attack contexts applicable to both NSA and SA
networks will be illustrated. I will begin by examining the weaknesses that are
more likely to occur in NSA architectures, before addressing more general
vulnerabilities.
% In questa sezione, verranno analizzate le vulnerabilità presenti nelle reti 5G,
% tenendo conto delle differenze legate alle architetture utilizzate. Le reti 5G
% possono essere suddivise in due categorie principali: il 5G Non-Standalone
% (NSA), un'architettura transitoria che si basa sull'infrastruttura 4G LTE per
% la gestione della segnalazione e del controllo, e il 5G Standalone (SA), che
% rappresenta una rete completamente autonoma. È fondamentale comprendere che le
% vulnerabilità possono manifestarsi in entrambe le architetture; tuttavia,
% alcune di esse possono risultare più comuni o rilevanti in una rispetto
% all'altra, in base alle specifiche implementazioni e tecnologie utilizzate. Di
% seguito, saranno illustrate alcune delle principali vulnerabilità facilmente
% sfruttabili in contesti di attacco, applicabili sia alle reti NSA che SA.\@
% Inizierò esaminando le debolezze che è più facile che si verifichino nelle
% architetture NSA, per poi trattare vulnerabilità più generali.\@

\subsection{Threats to the Radio Access Network}
Security threats to the Radio Access Network (RAN) focus on the vulnerabilities
of the radio part of the network, which includes base stations and mobile
devices. \\[0.2cm]
% \subsection{Minacce al Radio Access Network}
% Le minacce alla sicurezza del Radio Access Network (RAN) si concentrano sulle
% vulnerabilità della parte radio della rete, che include le stazioni base e i
% dispositivi mobili. \\[0.2cm]

\textbf{Information Leakage}:
Information loss can include threats such as the interception of
paging and the cracking of \texttt{\hyperlink{IMSI}{IMSI}}. Paging
interception is a passive scanning technique that exploits the
paging messages sent by base stations to mobile terminals. An
attacker, using a \texttt{\hyperlink{SDR}{SDR device}}
(software-defined radio), can capture RF signals in the vicinity
of the victim and detect the temporary identity of the mobile
subscriber (\hyperlink{S-TMSI}{S-TMSI}) or the paging cycle. By
exploiting this information, the attacker can calculate the
Paging Frame Index (PFI), limiting the possible IMSI candidates
for the victim to only 8. Subsequently, the attacker sends an
IMSI paging with these 8 candidates and observes the responses
to identify the victim's actual IMSI.
\\[0.2cm]
% \textbf{Fuga di informazioni}:
% La perdita di informazioni può comprendere minacce come l'intercettazione del
% paging e il cracking dell'\texttt{\hyperlink{IMSI}{IMSI}}. L'intercettazione
% del paging è una tecnica di scansione passiva che sfrutta i messaggi di paging
% inviati dalle stazioni base ai terminali mobili. Un attaccante, utilizzando un
% \texttt{\hyperlink{SDR}{dispositivo SDR}} (software-defined radio), può captare
% i segnali RF nelle vicinanze della vittima e rilevare l'identità temporanea del
% sottoscrittore mobile (\hyperlink{S-TMSI}{S-TMSI}) o il ciclo di paging.
% Sfruttando queste informazioni, l'attaccante può calcolare l'indice del frame di
% paging (PFI), limitando a soli 8 i possibili candidati IMSI della vittima. Successivamente,
% invia un paging IMSI con questi 8 candidati e osserva le risposte per individuare
% l'IMSI reale della vittima.
% \\[0.2cm]
\textbf{Denial of Service (DoS) for the User:}
This type of attack includes various forms,
such as DoS on the \texttt{\hyperlink{RRC}{RRC}} (Radio Resource Control)
connection, the rejection DoS \texttt{\hyperlink{RRC}{RRC}}, and the release
DoS \texttt{\hyperlink{RRC}{RRC}}.\@ The DoS on the \texttt{\hyperlink{RRC}{RRC}}
connection is particularly severe, as it exploits the
\texttt{\hyperlink{S-TMSI}{S-TMSI}} (SAE-Temporary Mobile Subscriber Identity)
of the victim, which was previously obtained through an information leakage.
Base stations do not implement authentication procedures for terminals,
allowing attackers to interfere with the victim's wireless access.
The attacker can send a connection request message \texttt{\hyperlink{RRC}{RRC}}
using the victim's \texttt{\hyperlink{S-TMSI}{S-TMSI}} value, leading to the
disconnection of the victim's \texttt{\hyperlink{RRC}{RRC}} connection and
establishing a connection with the attacker, who can then continue to send
requests to prevent legitimate access to the service.
\\[0.2cm]
% \textbf{Denial of Service (DoS) per l'utente:} Questo tipo di attacco include varie
% forme, come il DoS alla connessione \texttt{\hyperlink{RRC}{RRC}} (Radio Resource
% Control), il DoS di rifiuto \texttt{\hyperlink{RRC}{RRC}} e il DoS di rilascio
% \texttt{\hyperlink{RRC}{RRC}}.\@ Il DoS alla connessione \texttt{\hyperlink{RRC}{RRC}}
% è particolarmente grave, poiché sfrutta l'\texttt{\hyperlink{S-TMSI}{S-TMSI}}
% (SAE-Temporary Mobile Subscriber Identity) della vittima, precedentemente ottenuto
% attraverso una fuga di informazioni. Le stazioni base non implementano procedure di
% autenticazione per i terminali, consentendo agli attaccanti di interferire con
% l'accesso wireless della vittima. L'attaccante può inviare un messaggio di richiesta
% di connessione \texttt{\hyperlink{RRC}{RRC}} utilizzando il valore \texttt{\hyperlink{S-TMSI}{S-TMSI}}
% della vittima, portando alla disconnessione della connessione \texttt{\hyperlink{RRC}{RRC}}
% della vittima e stabilendo una connessione con l'attaccante, che può poi continuare a
% inviare richieste per impedire l'accesso legittimo al servizio.
% \\[0.2cm]
\textbf{DoS on the Base Station:}
A DoS attack can also target the depletion of the base station's resources,
making it difficult for legitimate users to connect. When a terminal attempts
to establish a connection, it uses the \texttt{\hyperlink{RRC}{RRC}} protocol,
which involves a random access process. Attackers can exploit this process to
send unauthorized requests, increasing the number of active \texttt{\hyperlink{RRC}{RRC}}
connections and overloading the base station, causing delays or disruptions in services.
\\[0.2cm]
% \textbf{DoS della stazione base:} Un attacco DoS può anche mirare a esaurire le risorse
% della stazione base, rendendo difficile per gli utenti legittimi connettersi. Quando un
% terminale cerca di stabilire una connessione, utilizza il protocollo \texttt{\hyperlink{RRC}{RRC}},
% che prevede un processo di accesso casuale. Gli attaccanti possono sfruttare questo processo
% per inviare richieste non autorizzate, aumentando il numero di connessioni \texttt{\hyperlink{RRC}{RRC}}
% attive e sovraccaricando la stazione base, causando ritardi o interruzioni nei servizi.
% \\[0.2cm]
\textbf{Eavesdropping:}
In theory, intercepting wireless networks should be impossible due to
the security settings between terminals and base stations. However, there
are cases where it is possible to extract the security key stream and decrypt
communications. Voice traffic in mobile communications uses the \hyperlink{RTP}{RTP}
(Real-time Transport Protocol) and is transmitted via a voice bearer, distinct from
the data bearer. To ensure Quality of Service (QoS), the voice bearer is dedicated,
with a separate QoS Class Identifier (QCI). During the creation of the key stream
for encryption in the AS security procedure, four parameters are used:
\texttt{count, direction, length, and bearer ID}. Of these, only the bearer
ID (DRB ID) represents a critical variable. The DRB ID is assigned when the base
station creates a voice bearer, but some base stations from certain manufacturers
may assign the same DRB ID within the same RRC connection, creating a vulnerability.
An attacker can exploit this flaw by intercepting the victim's encrypted voice
communication using a sniffer. After the call is over, the attacker can make a voice
call to the victim, intercepting both the clear and the encrypted calls. By applying
the XOR operation between the plaintext and ciphertext of the second call, the
attacker can extract the key stream, which can be used to decrypt the first call
since both used the same DRB ID and occurred in the same RRC connection.\@ To prevent
this type of attack, the 3GPP TS 33.401 standard recommends using different DRB IDs for
various bearers, thus preventing the reuse of the same DRB ID in the base station.
\\[0.2cm]
% \textbf{Eavesdropping:} In teoria, l'intercettazione delle reti wireless dovrebbe essere
% impossibile grazie alle impostazioni di sicurezza tra terminali e stazioni base.
% Tuttavia, esistono casi in cui è possibile estrarre il flusso di chiavi di sicurezza
% e decifrare le comunicazioni. Il traffico vocale nelle comunicazioni mobili utilizza il protocollo
% \hyperlink{RTP}{RTP} (Real-time Transport Protocol) ed è trasmesso tramite un bearer vocale,
% distinto dal bearer dati. Per garantire la qualità del servizio (QoS), il bearer vocale è
% dedicato, con un identificatore di classe QoS (QCI) separato. Durante la creazione del
% flusso di chiavi per la cifratura nella procedura di sicurezza AS, sono utilizzati quattro
% parametri: \texttt{conteggio, direzione, lunghezza e ID del bearer}. Di questi, solo l'ID
% del bearer (ID DRB) rappresenta una variabile critica. L'ID DRB viene assegnato quando la
% stazione base crea un bearer vocale, ma alcune stazioni base di determinati produttori
% possono assegnare lo stesso ID DRB all'interno della stessa connessione RRC, creando una vulnerabilità.
% Un attaccante può sfruttare questa falla intercettando la comunicazione vocale
% cifrata della vittima tramite uno sniffer. Dopo che la chiamata è terminata,
% l'attaccante può effettuare una chiamata vocale verso la vittima, intercettando sia la chiamata
% in chiaro che quella cifrata. Applicando l'operazione XOR tra il testo in chiaro e quello cifrato
% della seconda chiamata, l'attaccante è in grado di estrarre il flusso di chiavi,
% che può essere utilizzato per decifrare la prima chiamata, poiché entrambe hanno utilizzato
% lo stesso ID DRB e si sono svolte nella stessa connessione RRC.\@ Per evitare questo tipo di attacco,
% lo standard 3GPP TS 33.401 raccomanda di utilizzare ID DRB diversi per i vari bearer,
% prevenendo così il riutilizzo dello stesso ID DRB nella stazione base.
% \\[0.2cm]
\textbf{Unauthorized Data Usage:} In mobile networks, there are predefined and dedicated
bearers designed for legitimate communications. An attacker can exploit these bearers to
access data unauthorizedly, for example, by establishing cost-free communications.
Additionally, caller masquerading, also known as caller spoofing, is an attack in which
the attacker falsifies the caller's identity, deceiving the victim.
% \textbf{Utilizzo non autorizzato dei dati:} Nelle reti mobili esistono bearer predefiniti
% e dedicati, progettati per comunicazioni legittime. Un attaccante può sfruttare questi
% bearer per accedere ai dati in modo non autorizzato, ad esempio stabilendo
% comunicazioni senza costi. Inoltre, il masquerading del chiamante,
% noto anche come caller spoofing, è un attacco in cui l'attaccante falsifica l'identità
% del chiamante, ingannando la vittima.

\subsection{Core Network Security Threats}
\textbf{Information Leakage:} Information related to 5G NSA core networks can essentially
be classified into two categories: that concerning the EPC (Evolved Packet Core) equipment,
dedicated to data processing, and that related to the IMS (IP Multimedia Subsystem) equipment,
which provides various services. Since the EPC equipment uses the \hyperlink{GTP}{GTP} protocol
for communications, while the IMS equipment relies on the SIP (Session Initiation Protocol),
an attacker has the option to choose the most appropriate protocol to access the desired information.
The \hyperlink{GTP}{GTP} protocol is divided into two components: \hyperlink{GTP}{GTP-C},
used for communication between core network equipment, and \hyperlink{GTP}{GTP-U}, responsible for
transporting data traffic from the user terminal through a tunnel between the base station and the
PGW (Packet Gateway). To extract information about the EPC equipment's IP address, the attacker
can resort to a packet injection method, embedding an echo request in the payload of the data
along with a \hyperlink{GTP}{GTP-C} message for monitoring the health status of the network equipment.
By using a program called Packit, the Android Debug Bridge (ADB) command can be executed in the
Android terminal, thus generating a packet. By sending this packet to the IP address obtained
through the Tracert command in tethering mode, the \hyperlink{GTP}{GTP-C} packet is injected and
transmitted to the mobile communication network. Once the PGW receives the packet, it verifies it
and sends an echo response, allowing the attacker to identify the source IP of that message as PGWIP.\@
\\[0.2cm]
% \subsection{Core Network Security Threats}
% \textbf{Fuga di informazioni:}
% Le informazioni relative alle reti core 5G NSA possono essere essenzialmente
% classificate in due categorie: quelle riguardanti l'equipaggiamento EPC (Evolved Packet Core),
% dedicato all'elaborazione dei dati, e quelle concernenti l'equipaggiamento IMS (IP Multimedia Subsystem),
% che fornisce vari servizi. Poiché l'equipaggiamento EPC utilizza il protocollo
% \hyperlink{GTP}{GTP} per le comunicazioni,
% mentre l'equipaggiamento IMS si basa sul protocollo SIP (Session Initiation Protocol),
% un attaccante ha la possibilità di scegliere il protocollo più appropriato per accedere
% alle informazioni desiderate.
% Il protocollo \hyperlink{GTP}{GTP} si distingue in due componenti: \hyperlink{GTP}{GTP-C},
% impiegato per la comunicazione tra le attrezzature della rete core, e \hyperlink{GTP}{GTP-U},
% responsabile del trasporto del traffico dati dal terminale utente attraverso
% un tunnel tra la stazione base e il PGW (Packet Gateway). Per estrarre informazioni
% sull'indirizzo IP dell'equipaggiamento EPC, l'attaccante può ricorrere a un metodo di
% iniezione di pacchetti, caricando nel payload dei dati una richiesta di eco (echo request)
% insieme a un messaggio \hyperlink{GTP}{GTP-C} per il controllo dello stato di salute delle attrezzature di rete.
% Utilizzando un programma denominato Packit, è possibile eseguire il comando
% Android Debug Bridge (ADB) nel terminale Android, generando così un pacchetto.
% Inviando questo pacchetto all'indirizzo IP ottenuto tramite il comando Tracert in modalità tethering,
% il pacchetto \hyperlink{GTP}{GTP-C} viene iniettato e trasmesso alla rete di comunicazione mobile.
% Il PGW, una volta ricevuto il pacchetto, lo verifica e invia una risposta di eco,
% consentendo all'attaccante di identificare l'IP sorgente di quel messaggio come PGWIP.\@
% \\[0.2cm]
\textbf{IP Address Exhaustion:} By using the GTP-in-GTP technique, an attacker can exhaust
the pool of IP addresses in the network by sending session requests with incremented terminal numbers,
thereby preventing legitimate terminals from connecting. This technique exploits a vulnerability
in the GTP (GPRS Tunneling Protocol), which is used for data transport in mobile networks.
GTP-in-GTP involves encapsulating GTP packets within other GTP packets, allowing the attacker
to send multiple requests in a single connection. The attacker creates GTP sessions within other
GTP sessions, amplifying the attack and increasing the number of requests generated, thereby
accelerating the depletion of network resources. This technique proves particularly effective
as it takes advantage of the overhead associated with managing GTP sessions, causing a strain
on the IP address allocation system.\@
[0.2cm]
% \textbf{Esaurimento degli indirizzi IP:} Utilizzando la tecnica GTP-in-GTP, un attaccante
% può esaurire il pool di indirizzi IP della rete inviando richieste di sessione con numeri
% di terminale incrementati, impedendo così ai terminali legittimi di connettersi.
% Questa tecnica sfrutta la vulnerabilità del protocollo GTP (GPRS Tunneling Protocol),
% utilizzato per il trasporto di dati nelle reti mobili. GTP-in-GTP implica l'incapsulamento
% di pacchetti GTP all'interno di altri pacchetti GTP, consentendo all'attaccante di inviare
% richieste multiple in una singola connessione. L'attaccante crea delle sessioni GTP all'interno
% di altre sessioni GTP, amplificando l'attacco e aumentando il numero di richieste generate,
% rendendo ancora più rapido l'esaurimento delle risorse di rete. Questa tecnica si rivela
% particolarmente efficace perché sfrutta l'overhead di gestione delle sessioni GTP,
% causando un sovraccarico del sistema di allocazione degli indirizzi IP.\@
% \\[0.2cm]

\textbf{Denial of Service (DoS):} A DoS attack can be executed by repeatedly sending
connection request messages to the 5G NSA network, overwhelming the core network and
causing service disruption.
\\[0.2cm]
% \textbf{Denial of Service (DoS):} Un attacco DoS può essere eseguito inviando ripetutamente
% messaggi di richiesta di connessione alla rete 5G NSA, sovraccaricando il core di rete e
% causando l'interruzione del servizio.
% \\[0.2cm]

\textbf{NAS Manipulation:} Messages from the NAS protocol, used for signaling between
terminals and the core network, are not always protected by encryption. An attacker
can exploit this vulnerability by installing a malicious base station to manipulate
messages and alter critical parameters for data encryption and integrity.
\\[0.2cm]
% \textbf{Manipolazione del NAS:} I messaggi del protocollo NAS, utilizzati per la segnalazione
% tra terminali e core di rete, non sempre sono protetti da cifratura. Un attaccante può
% sfruttare questa vulnerabilità installando una stazione base malevola per manipolare i
% messaggi e alterare i parametri critici per la cifratura e l'integrità dei dati.
% \\[0.2cm]

\textbf{Eavesdropping:} Voice communication over a 5G network utilizes the IMS
network and initiates sessions via the SIP protocol, following the guidelines
established by the 3GPP standard. Consequently, the security of the SIP protocol
is crucial and is primarily ensured through the Security Associations (SAs) of IPSec.
However, the implementation of IPSec SAs is selectively managed by 5G network operators,
and support for VoLTE (Voice over LTE) does not necessarily imply full IPSec coverage
due to the significant impact it could have on terminal performance. For instance,
the Samsung Galaxy S10 supports IPSec but has an issue: the related setting can be
disabled through a hidden menu. If an attacker gains remote access to this hidden
menu and modifies the IPSec setting, the victim's voice communications will occur
without encryption. Furthermore, if the EEA field is altered through NAS
(Non-Access Stratum) manipulation and a NAS encryption algorithm is not used,
the wireless communication in the AS (Access Stratum) section will also be unencrypted.
In such a scenario, the attacker can intercept the wireless traffic using a
man-in-the-middle (MitM) attack, allowing them to eavesdrop on the victim's
unencrypted voice traffic.
\\[0.2cm]
% \textbf{Intercettazione:} La comunicazione vocale su una rete 5G sfrutta la rete IMS e
% avvia le sessioni tramite il protocollo SIP, seguendo le direttive stabilite dallo standard 3GPP.
% Di conseguenza, la sicurezza del protocollo SIP è cruciale e viene principalmente garantita attraverso
% le associazioni di sicurezza (SA) dell'IPSec. Tuttavia, l'implementazione di IPSec SA è
% gestita in modo selettivo dagli operatori delle reti 5G, e il supporto per il VoLTE (Voice over LTE)
% non implica necessariamente una copertura totale dell'IPSec,
% a causa dell'impatto significativo che potrebbe avere sulle prestazioni del terminale.
% Prendiamo ad esempio il Samsung Galaxy S10,
% che supporta IPSec, ma presenta un problema: l'impostazione relativa può essere disattivata tramite
% un menu nascosto. Se un attaccante riesce a ottenere l'accesso remoto a questo menu nascosto e
% modifica l'impostazione di IPSec, le comunicazioni vocali della vittima avverranno senza cifratura.
% Inoltre, se il campo EEA viene alterato mediante una manipolazione del NAS (Non-Access Stratum)
% e non viene utilizzato un algoritmo di cifratura NAS, anche la comunicazione wireless nella
% sezione AS (Access Stratum) risulterà non cifrata. In tale scenario, l'attaccante può intercettare
% il traffico wireless utilizzando un attacco man-in-the-middle (MitM), permettendogli di ascoltare
% il traffico vocale della vittima privo di cifratura.
% \\[0.2cm]
\textbf{Spoofing:} IP spoofing is a common attack in which the attacker sends packets with
falsified IP addresses, causing billing issues and potential DoS attacks. Additionally,
spoofing the \texttt{from} field in SIP or MMS packets can be used for voice phishing,
presenting falsified numbers on the receiving terminal.
% \textbf{Spoofing:} Lo spoofing di IP è un attacco comune in cui l'attaccante invia pacchetti
% con indirizzi IP falsificati, causando problemi di fatturazione e potenziali attacchi DoS.
% Inoltre, lo spoofing del campo \texttt{from} nei pacchetti SIP o MMS può essere utilizzato
% per il voice phishing, presentando numeri falsificati sul terminale ricevente.

\subsection{Countermeasures}
We can consider an approach to countermeasures against security threats to 5G
on two levels: the standardization of security guidelines and detection through
intrusion detection systems or intrusion prevention systems. \\[0.2cm]
\textbf{Denial of Service (DoS) of the RRC connection}.\@\\
The main cause of the DoS threat on the RRC connection is that the RRC connection request,
a message transmitted when a user terminal accesses the network, is sent in clear text,
and the message includes the TMSI, a temporary identification information of the user terminal.
To address this, it is necessary to verify the spoofing of RRC messages at the base station level,
which is not easy to define in the 3GPP specifications.\@ Furthermore, blocking attackers from
discovering the temporary identification information of a specific user can be a way to verify,
but even this is not simple, as there are too many known methods. The use of temporary identification
information in the RRC connection request serves to prevent privacy invasion caused by the leakage
and abuse of the IMSI, which is the subscriber identification information within the USIM.
However, attackers can intercept the clear text RRC connection request messages and easily
identify the TMSI. From this, the attacker can create and send a modulated RRC connection
request message so that the base station confuses the message with one sent from the victim's
terminal. In the core network, the temporary identification information is created at specified
time intervals according to specific rules based on the IMSI, and even if the TMSI is changed,
the attacker can identify the changed TMSI and recreate an attack message. When receiving the
modulated RRC connection request, the base stations disconnect the existing victim terminal
without verifying the modulation state and allow access to the attacker's terminal. In such
a situation, if the base station does not disconnect the existing victim terminal or maintains
the connection for a certain period of time, it can reduce the victim's DoS threat. Since the
attacker's terminal fails authentication after the RRC connection, maintaining the connection
with the existing terminal only during the period when the attacker's terminal sends the RRC
connection request and the authentication fails may not significantly affect the performance
of the base station.\\[0.2cm]
% \subsection{Contromisure}
% Possiamo considerare un approccio alle contromisure contro le minacce alla
% sicurezza del 5G su due livelli: la standardizzazione delle linee guida di
% sicurezza e il rilevamento tramite sistemi di rilevamento delle intrusioni o
% sistemi di prevenzione delle intrusioni. \\[0.2cm]
% \textbf{Denial of Service (DoS) della connessione RRC}.\@ \\
% La causa principale della minaccia di DoS sulla connessione
% RRC è che la richiesta di connessione RRC, un messaggio trasmesso quando un terminale
% utente accede alla rete, viene inviata in chiaro, e il messaggio include il TMSI,
% un'informazione di identificazione temporanea del terminale utente. Per rispondere
% a questo, è necessario verificare la contraffazione dei messaggi RRC a livello di
% stazione base, il che non è facile da definire nelle specifiche 3GPP.\@ Inoltre,
% bloccare gli aggressori dal scoprire l'informazione di identificazione temporanea
% di un utente specifico può essere un modo per verificare, ma anche questo non è
% semplice, poiché esistono troppi metodi noti. L'utilizzo dell'informazione di
% identificazione temporanea nella richiesta di connessione RRC serve a prevenire
% l'invasione della privacy causata dalla fuga e dall'abuso dell'IMSI, che è
% l'informazione di identificazione dell'abbonato all'interno della USIM. Tuttavia,
% gli aggressori possono intercettare i messaggi di richiesta di connessione RRC
% inviati in chiaro e identificare facilmente il TMSI. Da ciò, l'aggressore può creare
% e inviare un messaggio di richiesta di connessione RRC modulato in modo che la
% stazione base confonda il messaggio con uno inviato dal terminale della vittima.
% Nella rete centrale, l'informazione di identificazione temporanea viene creata a
% intervalli di tempo secondo regole specifiche basate sull'IMSI, e anche se il
% TMSI viene cambiato, l'aggressore può identificare il TMSI cambiato e creare
% nuovamente un messaggio di attacco. Quando riceve la richiesta di connessione
% RRC modulata, le stazioni base annullano la connessione al terminale esistente
% della vittima senza verificare lo stato di modulazione e consentono l'accesso
% al terminale dell'aggressore. In tale situazione, se la stazione base non disconnette
% il terminale esistente della vittima o mantiene la connessione per un certo periodo
% di tempo, può ridurre la minaccia di DoS della vittima. Poiché il terminale
% dell'aggressore fallisce l'autenticazione dopo la connessione RRC, mantenere
% la connessione con il terminale esistente solo durante il periodo in cui il
% terminale dell'aggressore invia la richiesta di connessione RRC e l'autenticazione
% fallisce potrebbe non influenzare significativamente le prestazioni della stazione base.

\textbf{NAS Manipulation (NAS Encryption Spoofing)}. \\
The 5G standard from 3GPP supports both integrity verification and encrypted
communication to strengthen the security of the NAS protocol between terminals
and 5G core networks. However, since encrypted communication is not mandatory
but an optional feature among the security functions of the NAS protocol,
there are some cases where security functions are not used due to the policy
of the country or the mobile operator. Besides emergency calls, some countries
or operators may not utilize the encryption capabilities provided by 5G
standards in terms of security. Furthermore, the 5G standard does not define
mutual authentication between terminals (UE) and 5G networks, nor the integrity
verification function for the initial messages exchanged before encryption,
relying on an underlying assumption that presumes the initial messages are not
modulated. This issue arises from a vulnerability that does not confirm the
spoofing of the first access request message (attack request) sent to the 5G
network by the UE.\@ A malicious attacker infiltrates between the victim's UE
and a base station, manipulates an access request message that includes a request
for encryption and integrity verification normally sent by the terminal into an
access request message with encryption disabled and unverified integrity, and
sends it to a regular base station.
% \textbf{Manipolazione NAS (spoofing della cifratura NAS)}. \\Lo standard 5G della 3GPP supporta sia
% la verifica dell'integrità che la comunicazione cifrata per rafforzare la sicurezza del
% protocollo NAS tra i terminali e le reti centrali 5G. Tuttavia, poiché la comunicazione
% cifrata non è obbligatoria ma una funzione opzionale tra le funzioni di sicurezza del
% protocollo NAS, ci sono alcuni casi in cui le funzioni di sicurezza non vengono utilizzate
% a causa della politica del paese o dell'operatore mobile. Oltre alle chiamate di emergenza,
% alcuni paesi o operatori potrebbero non utilizzare le capacità di cifratura fornite dagli
% standard 5G in termini di sicurezza. Inoltre, lo standard 5G non definisce l'autenticazione
% reciproca tra terminali (UE) e reti 5G né la funzione di verifica dell'integrità dei messaggi
% iniziali scambiati prima della cifratura, basandosi su un affidamento sottostante che presume
% che i messaggi iniziali non siano modulati. Questo problema deriva da una vulnerabilità
% che non conferma la contraffazione del primo messaggio di richiesta di accesso (richiesta di attacco)
% alla rete 5G inviato dall'UE.\@ Un attaccante malintenzionato si infiltra tra l'UE della vittima e
% una stazione base, manipola un messaggio di richiesta di accesso che include una richiesta di
% cifratura e verifica dell'integrità normalmente inviato dal terminale in un messaggio di richiesta
% di accesso con cifratura disabilitata e integrità non verificata, e lo invia a una stazione base normale.

The equipment of the 5G core network (MME) forms an unencrypted channel with
the UE according to the request to disable encryption, a manipulated message
different from the original message sent by the UE, even if the activation of
encryption is set by default. This issue occurs because the 3GPP standard does
not incorporate an integrity authentication procedure to check the spoofing of
the initial message before the mutual authentication phase, leading to
unencrypted communication caused by unencrypted and unverified integrity
manipulated UE messages.
% Le apparecchiature della rete centrale 5G (MME) formano un canale non cifrato
% con l'UE secondo la richiesta di disabilitazione della cifratura, un messaggio
% manipolato diverso dal messaggio originale inviato dall'UE, anche se
% l'attivazione della cifratura è predefinita. Questo problema si verifica perché
% lo standard 3GPP non incorpora una procedura di autenticazione dell'integrità
% per controllare la contraffazione del messaggio iniziale prima della fase di
% autenticazione reciproca, il che porta a una comunicazione non cifrata causata
% da messaggi UE manipolati non cifrati e non verificati per l'integrità.

Two threats may arise from this: the first is the manipulation of message
content. There are vulnerabilities or risks where malicious attackers can
manipulate the messages sent from a victim's terminal at will. This is due to
the fact that the standard does not define any integrity verification procedure
to check whether the access request messages sent from a terminal during the
initial access to the communication network have been manipulated or not. The
second threat is the interception of communications. Due to a request to
disable encryption within the modulated initial access message, communication
between the terminal and the 5G network will be formed as an unencrypted
channel, allowing a malicious attacker to intercept all wireless communications
and expose personal and location information contained in the exchanged
messages. An attacker can disable encryption settings between the victim's
terminal and the core network using a fake base station to utilize the victim's
data or intercept the message content. We have implemented an algorithm to
detect this and conducted performance detection tests. By analyzing the
encryption fields in the NAS protocol messages between terminals and core
networks, it is possible to set up encryption bypass channels or determine if
they are non-standard terminals.
% Possono sorgere due minacce da questo, la prima è la manipolazione del
% contenuto del messaggio. Ci sono vulnerabilità o rischi in cui gli aggressori
% malintenzionati possono modulare i messaggi inviati dal terminale di una
% vittima a loro piacimento. Ciò è dovuto al fatto che lo standard non definisce
% alcuna procedura di verifica dell'integrità per controllare se i messaggi di
% richiesta di accesso inviati da un terminale durante il primo accesso alla rete
% di comunicazione siano stati manipolati o meno. La seconda minaccia è
% l'intercettazione delle comunicazioni. A causa di una richiesta di
% disabilitazione della cifratura all'interno del messaggio di accesso iniziale
% modulato, la comunicazione tra il terminale e la rete 5G sarà formata come un
% canale non cifrato, consentendo a un aggressore malintenzionato di intercettare
% tutte le comunicazioni wireless e di esporre le informazioni personali e di
% localizzazione contenute nei messaggi scambiati. Un aggressore può disabilitare
% le impostazioni di cifratura tra il terminale della vittima e la rete centrale
% utilizzando una stazione base falsa per utilizzare i dati della vittima o per
% intercettare il contenuto del messaggio. Abbiamo implementato un algoritmo per
% rilevare questo e condotto test di prestazione di rilevamento. Analizzando i
% campi di cifratura nei messaggi del protocollo NAS tra terminali e reti
% centrali, è possibile impostare canali di bypass della cifratura o determinare
% se si tratta di terminali non standard. 
% \\[0.2cm]

\textbf{Interception (SIP spoofing).}\\
Since interception caused by SIP spoofing is possible when IPSec is disabled,
it is necessary to ensure that the encryption settings for voice communication
between terminals and the 5G network are managed by the mobile operator's network,
rather than being processed according to the terminal's function (a selective
application in the network is required for non-IPSec supporting terminals). If
the IPSec setting for the 5G voice service is determined by the terminal's function,
malicious users may attempt multiple attacks exploiting the settings of their terminal.
Furthermore, efforts should be made to raise awareness and publicize the risk of
communication detail leaks when attackers maliciously manipulate messages and engage
in unencrypted communications between the terminal and the 5G network. The applicable
section for IPSec is defined as local policy in the 3GPP, but it is necessary to
consider making it mandatory at the 3GPP standard level. Consequently, we have
attempted to present a vulnerability report on the issues described above to the
3GPP and have discussed these matters through collaboration with a research group.
Guidelines for the proper configuration and activation of the IPSec protocol in the
5G network could be incorporated in the next revision of the 3GPP specifications.
% \textbf{Intercettazione (spoofing SIP)}.\\ Poiché l'intercettazione causata dallo spoofing
% SIP è possibile quando l'IPSec è disattivato, è necessario guidare le
% impostazioni di cifratura della comunicazione vocale tra i terminali e la rete
% 5G per essere gestite dalla rete dell'operatore mobile, invece di essere
% elaborate secondo la funzione del terminale (è necessaria un'applicazione
% selettiva nella rete per i terminali non supportivi dell'IPSec). Se
% l'impostazione IPSec del servizio vocale 5G è determinata dalla funzione del
% terminale, gli utenti malintenzionati potrebbero tentare più attacchi
% sfruttando le impostazioni del loro terminale. Inoltre, è necessario fare
% sforzi per sensibilizzare e pubblicizzare il rischio di fuga dei dettagli di
% comunicazione quando gli aggressori modulano maliziosamente i messaggi e si
% impegnano in comunicazioni non cifrate tra il terminale e la rete 5G. La
% sezione applicabile per l'IPSec è definita come politica locale nella 3GPP, ma
% è necessario esaminare se renderla obbligatoria a livello di standard 3GPP. Di
% conseguenza, abbiamo provato a presentare un rapporto di vulnerabilità sui
% problemi sopra descritti alla 3GPP e abbiamo discusso queste questioni
% attraverso una collaborazione con un gruppo di ricerca. Le linee guida per la
% corretta configurazione e attivazione del protocollo IPSec nella rete 5G
% potrebbero essere incorporate nella prossima revisione delle specifiche 3GPP.

\subsection{GUTI Reallocation Command Attack}
The 5G-GUTI (Globally Unique Temporary Identifier) is a temporary identifier
assigned to users to ensure their privacy. In some 5G SA (Standalone) networks,
this identifier is reassigned in a random and unpredictable manner. The
vulnerability lies in the fact that the command for GUTI reassignment is sent
without security protection, either in terms of integrity or
encryption~\cite{eleftherakis2024demystifying}. Attackers can exploit this
vulnerability in various ways:
\begin{itemize}
	\item \textbf{Man-in-the-Middle (MiTM)}:
	      An attacker can intercept the configuration update message
	      and modify the 5G-GUTI value. If the UE attempts to re-establish
	      a connection using this altered value, the network will not recognize
	      it, leading to a Denial of Service (DoS) attack.
	\item \textbf{GUTI Refreshment Neutralization}:
	      This attack exploits the lack of an acknowledgment (ACK)
	      request in the configuration update message. If the UE does
	      not send a completion message, the attacker can block or alter
	      the commands without consequences.
	\item \textbf{Victim Tracking}:
	      The absence of encryption in the GUTI reassignment command
	      allows attackers to track users' locations. They can send
	      silent messages (which do not trigger notifications) and
	      observe the network's responses to determine the UE's
	      presence in specific geographical areas.
\end{itemize}

\subsubsection{Difficulties in Wide Network Scenarios}
In a network with many connected devices, it is complicated for the attacker to
isolate a single device due to the number of messages sent. However, they can
improve the accuracy of the attack by sending messages at specific intervals or
during low-activity times.

\subsubsection{Operator Responsibilities and Countermeasure}
The identified vulnerabilities stem from implementation errors in 5G networks.
In particular, operators should not send NAS messages without ensuring
integrity. Additionally, the lack of encryption is a design choice, according
to 3GPP documents, which make encryption optional. In conclusion, to mitigate
this problem, operators should send these messages ensuring their integrity
through encryption.
% \subsection{GUTI Reallocation Command Attack}
% Il 5G-GUTI (Globally Unique Temporary Identifier) è un identificatore
% temporaneo assegnato agli utenti per garantire la loro privacy. In alcune reti
% 5G SA (Standalone), questo identificatore viene riassegnato in modo casuale e
% non prevedibile. La vulnerabilità risiede nel fatto che il comando per la
% riassegnazione del GUTI viene inviato senza protezione di sicurezza, né in
% termini di integrità né di crittografia~\cite{eleftherakis2024demystifying}.
% Gli attaccanti possono sfruttare questa vulnerabilità in diversi modi:
% \begin{itemize}
% 	\item \textbf{Man-in-the-Middle (MiTM)}: Un attaccante può intercettare il messaggio di aggiornamento della configurazione e modificarne il valore 5G-GUTI. Se l'UE cerca di ristabilire una connessione usando questo valore alterato, la rete non lo riconoscerà, portando a un attacco di Denial of Service (DoS).
% 	\item \textbf{GUTI Refreshment Neutralization}: Questo attacco sfrutta la mancanza di una richiesta di riconoscimento (ACK) nel messaggio di aggiornamento della configurazione. Se l'UE non invia un messaggio di completamento, l'attaccante può bloccare o alterare i comandi senza conseguenze.
% 	\item \textbf{Tracciamento della Vittima}: L'assenza di crittografia nel comando di riassegnazione GUTI consente agli attaccanti di tracciare la posizione degli utenti. Possono inviare messaggi silenziosi (che non attivano notifiche) e osservare le risposte della rete per determinare la presenza dell'UE in specifiche aree geografiche.
% \end{itemize}

% \subsubsection{Difficoltà in Scenari di Rete Ampia}
% In una rete con molti dispositivi connessi, è complicato per l'attaccante
% isolare un singolo dispositivo a causa del numero di messaggi inviati.
% Tuttavia, possono migliorare l'accuratezza dell'attacco inviando messaggi a
% intervalli specifici o in orari di bassa attività.

% \subsubsection{Responsabilità degli Operatori e contromisura}
% Le vulnerabilità identificate derivano da errori di implementazione nelle reti
% 5G. In particolare, gli operatori non dovrebbero inviare messaggi NAS senza
% garantire l'integrità. Inoltre, la mancanza di crittografia è una scelta
% progettuale, secondo i documenti 3GPP, che rendono la crittografia facoltativa.
% In conclusione, per mitigare questo problema basterebbe da parte degli operatoi
% inviare questi messaggi garantendone l'integrità tramite crittografia.

\subsection{Security Capabilities Bidding-Down Attack}
The Bidding-Down Attack is a vulnerability that can manifest in certain
implementations of 5G networks, particularly in non-standalone (NSA) and
standalone (SA) networks of operators that do not correctly follow the security
specifications defined by 3GPP, meaning they do not adequately verify the
security capabilities supported by the User Equipment (UE) (i.e., they cannot
distinguish between the security capabilities communicated in the initial
registration request and those received in the NAS Security Mode Command (SMC)
message). This attack exploits weaknesses in the security capabilities
negotiation process between the user device (UE) and the network, with
potential negative consequences for the confidentiality and integrity of
transmitted data~\cite{eleftherakis2024demystifying}.

When a UE sends a registration request to the network, it communicates its
security capabilities, specifying the supported encryption and integrity
algorithms. However, an active attacker in a man-in-the-middle mode can
intercept this message and modify it, replacing the communicated security
algorithms with weaker ones.

Subsequently, the authentication procedure based on 5G-AKA is executed. Once
the authentication is completed, the core network (CN) sends a NAS Security
Mode Command (SMC) to the UE. In NSA and SA 5G network implementations, the NAS
SMC command does not include a message authentication code (MAC), meaning that
the UE cannot verify the integrity of the received message. Therefore, the
attacker can again alter the security algorithms, causing the device to accept
the weaker ones, leading to a complete compromise of security.

Thus, the Bidding-Down Attack poses a serious threat in 5G network
implementations that do not adequately implement security mechanisms,
highlighting the importance of following established guidelines to ensure the
protection of communications.

To avoid the Bidding-Down Attack, several measures can be taken. Firstly, it is
essential to always include a message authentication code (MAC). Another
important aspect is the implementation of robust verification mechanisms. It is
crucial for the network to perform accurate checks on the security capabilities
communicated by the UE, comparing what the device claims to support with what
the network is capable of handling. This way, it is possible to detect and
prevent the acceptance of weaker security algorithms. Additionally, it is
fundamental to use advanced security algorithms. Networks should avoid using
obsolete or less secure algorithms, opting instead for the most recent and
robust ones that offer adequate protection against such attacks.

% \subsection{ Security Capabilities Bidding-Down Attack}
% Il Bidding-Down Attack è una vulnerabilità che può manifestarsi in alcune
% implementazioni delle reti 5G, in particolare nelle reti non standalone (NSA) e
% nelle reti standalone (SA) di operatori che non seguono correttamente le
% specifiche di sicurezza definite dalla 3GPP, cioè non eseguono adeguatamente la
% verifica delle capacità di sicurezza supportate dall'UE (non può comprendere la
% differenza tra le capacità di sicurezza supportate comunicate nella richiesta
% di registrazione iniziale e quelle ricevute nel messaggio NAS SMC).\@ Questo
% attacco sfrutta le debolezze nel processo di negoziazione delle capacità di
% sicurezza tra il dispositivo utente (UE) e la rete, con potenziali conseguenze
% negative sulla riservatezza e l'integrità dei dati
% trasmessi~\cite{eleftherakis2024demystifying}.

% Quando un UE invia una richiesta di registrazione alla rete, comunica le
% proprie capacità di sicurezza, specificando gli algoritmi di cifratura e di
% integrità supportati. Tuttavia, un attaccante attivo in modalità
% man-in-the-middle può intercettare questo messaggio e modificarlo, sostituendo
% gli algoritmi di sicurezza comunicati con quelli più deboli.

% Successivamente, viene eseguita la procedura di autenticazione basata su
% 5G-AKA. Una volta completata l'autenticazione, la rete centrale (CN) invia un
% comando NAS Security Mode Command (SMC) al UE. Nelle implementazioni delle reti
% 5G NSA e SA, il comando NAS SMC non include un codice di autenticazione del
% messaggio (MAC), il che significa che il UE non è in grado di verificare
% l'integrità del messaggio ricevuto. Pertanto, l'attaccante può nuovamente
% alterare gli algoritmi di sicurezza, inducendo il dispositivo ad accettare
% quelli più deboli, portando a una completa compromissione della sicurezza.

% Quindi, il Bidding-Down Attack rappresenta una seria minaccia nelle
% implementazioni di reti 5G che non implementano adeguatamente meccanismi di
% sicurezza, evidenziando l'importanza di seguire le linee guida stabilite per
% garantire la protezione delle comunicazioni.

% Per evitare il Bidding-Down Attack, ci sono diverse misure che possono essere
% adottate. Innanzitutto, è fondamentale includere sempre un codice di
% autenticazione del messaggio (MAC). Un altro aspetto importante è
% l'implementazione di meccanismi di verifica robusti. È essenziale che la rete
% esegua controlli accurati sulle capacità di sicurezza comunicate dall'UE,
% confrontando ciò che il dispositivo dichiara di supportare con quello che la
% rete è in grado di gestire. In questo modo, si può rilevare e prevenire
% l'accettazione di algoritmi di sicurezza più deboli. In aggiunta, è
% fondamentale utilizzare algoritmi di sicurezza avanzati. Le reti dovrebbero
% evitare l'uso di algoritmi obsoleti o meno sicuri, optando per quelli più
% recenti e robusti, che offrano una protezione adeguata contro attacchi di
% questo tipo.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusions}\label{Conclusions}
The 5G technology represents one of the latest frontiers in the field of
wireless communications. It has the potential to revolutionize many human
activities and our way of conceiving modern communications, thanks to high
transmission speeds, low latency, and high throughput. However, with the
advancement of mobile technology, new threats also develop that can compromise
the security of these networks. This article has analyzed the main
vulnerabilities associated with 5G. Many of these vulnerabilities are inherited
from 4G, while others are completely new. Research on security and the
identification of innovative solutions is a crucial task for all stakeholders
involved, from network service providers to those defining communication
protocols. This becomes particularly necessary, considering that 5G is
increasingly fundamental for sectors of everyday life that can become extremely
sensitive if not managed properly, such as telemedicine and autonomous
vehicles. The evolution of cybersecurity in the context of 5G is not only a
response to existing threats but also a challenge to anticipate and mitigate
future risks, given the growing global interconnectedness. Key technologies
such as artificial intelligence and machine learning offer significant
potential to enhance network protection by identifying sophisticated threats
and large-scale attacks in real-time. Additionally, cryptography must evolve to
address new forms of attack, including those that could emerge from the use of
quantum computers. Looking ahead, it is clear that the security of 5G will
become an increasingly central aspect, especially with the increase of
connected IoT devices and the use of 5G in critical infrastructures. Without
adequate protection, the consequences could be devastating, jeopardizing not
only user privacy but also the stability of economic and social systems.
International cooperation, the development of new technologies, and the
definition of increasingly stringent standards will be essential to ensure that
5G is not only a driver of progress but also a secure platform for future
generations.

% \section{Conclusions}\label{Conclusions}
% La tecnologia 5G rappresenta una delle ultime frontiere nel campo delle
% comunicazioni senza fili. Essa ha il potenziale di rivoluzionare molte attività
% umane e il nostro modo di concepire le comunicazioni moderne, grazie a elevate
% velocità di trasmissione, bassa latenza e un alto throughput. Tuttavia, con
% l'avanzamento della tecnologia mobile, si sviluppano anche nuove minacce che
% possono compromettere la sicurezza di queste reti. In questo articolo, sono
% state analizzate le principali vulnerabilità associate al 5G. Molte di queste
% vulnerabilità sono ereditate dal 4G, mentre altre sono completamente nuove. La
% ricerca sulla sicurezza e l'identificazione di soluzioni innovative
% rappresentano un compito cruciale per tutti gli attori coinvolti, dai fornitori
% di servizi di rete a coloro che definiscono i protocolli di comunicazione.
% Questo diventa particolarmente necessario, considerando che il 5G è sempre più
% fondamentale per settori della vita quotidiana che possono diventare
% estremamente delicati se non gestiti correttamente, come la telemedicina e i
% veicoli a guida autonoma. L’evoluzione della cybersecurity nel contesto del 5G
% non è solo una risposta alle minacce esistenti, ma anche una sfida per
% prevedere e mitigare rischi futuri, considerando la crescente interconnessione
% globale. Tecnologie chiave come l'intelligenza artificiale e il machine
% learning offrono un potenziale significativo per migliorare la protezione delle
% reti, identificando in tempo reale minacce sofisticate e attacchi su larga
% scala. Inoltre, la crittografia deve evolversi per far fronte a nuove forme di
% attacco, inclusi quelli che potrebbero emergere dall’uso di computer
% quantistici. Guardando al futuro, è chiaro che la sicurezza del 5G diventerà un
% aspetto sempre più centrale, soprattutto con l'incremento dei dispositivi IoT
% connessi e l’utilizzo del 5G in infrastrutture critiche. Senza una protezione
% adeguata, le conseguenze potrebbero essere devastanti, mettendo a rischio non
% solo la privacy degli utenti, ma anche la stabilità dei sistemi economici e
% sociali. La cooperazione internazionale, lo sviluppo di nuove tecnologie e la
% definizione di standard sempre più stringenti saranno essenziali per garantire
% che il 5G sia non solo un motore di progresso, ma anche una piattaforma sicura
% per le generazioni future.

\clearpage
\appendix
\section{Terms to Remember}
\begin{itemize}
	\item \textbf{\hypertarget{MIMO}{Massive MIMO}}:
	      Wireless Multiple Input Multiple Output systems utilize multiple
	      transmission and reception antennas to increase network capacity,
	      enhancing data throughput and serving a larger number of users.
	      MIMO divides the signal into low-speed sub-signals, transmitted
	      on spatially separated antennas over the same frequency channel.
	      Through multi-path propagation, the receiver separates the signals
	      into parallel streams to recover the original signal. MIMO increases
	      channel capacity without consuming additional bandwidth or power,
	      and speed can grow by adding more antennas. In 5G, Massive MIMO
	      technology goes beyond the $2 \times 2$ configuration of 4G,
	      utilizing numerous simultaneous streams to enhance network
	      capacity and spectral efficiency. The larger antenna array
	      allows coherent signal processing, rapidly adapting to changes in
	      the propagation channel~\cite{Kathavate2021Critical}.
	      % \appendix
	      % \section{Termini da ricordare}
	      % \begin{itemize}
	      % 	\item \textbf{\hypertarget{MIMO}{Massive MIMO}}:
	      % 	      I sistemi wireless Multiple Input Multiple Output
	      % 	      sfruttano più antenne di trasmissione e ricezione per aumentare la capacità di rete,
	      % 	      migliorando il throughput dei dati e servendo un maggior numero di utenti. MIMO suddivide
	      % 	      il segnale in sottosegnali a bassa velocità, trasmessi su antenne spazialmente separate
	      % 	      sullo stesso canale di frequenza. Grazie alla propagazione su percorsi multipli, il
	      % 	      ricevitore separa i segnali in flussi paralleli per recuperare il segnale originale.
	      % 	      MIMO aumenta la capacità del canale senza consumare ulteriore larghezza di banda o
	      % 	      potenza e la velocità può crescere aggiungendo più antenne. Nel 5G, la tecnologia
	      % 	      Massive MIMO va oltre la configurazione $2 \times 2$ del 4G, utilizzando numerosi
	      % 	      flussi simultanei per aumentare la capacità di rete e l'efficienza spettrale.
	      % 	      L'array di antenne più grande permette un'elaborazione coerente del segnale, adattandosi
	      % 	      velocemente ai cambiamenti del canale di propagazione~\cite{Kathavate2021Critical}.

	\item \textbf{\hypertarget{mmWave}{mmWave}}:
	      Millimeter wave communications refer to the use of very high electromagnetic waves,
	      typically ranging between \textit{30 GHz and 300 GHz}. These waves are called millimeter
	      waves because their wavelength varies between 1 mm and 30 mm, which are much shorter
	      than the traditionally used radio waves. They enable very high speeds and low latency
	      but have limited range and poor penetration capability, requiring dense infrastructure
	      such as small cells and advanced technologies like beamforming. When used in conjunction
	      with lower frequencies to ensure complete coverage, mmWave is crucial for enhancing network
	      capacity in high-density user areas.
	      % \item \textbf{\hypertarget{mmWave}{mmWave}}:
	      %       Le comunicazioni ad onde millimetriche
	      %       si rifereiscono all'uso di onde elettromagnetiche molto elevate, tipicamente comprese
	      %       tra \textit{30 GHz e 300GHz}. Questo onde sono chiamate millimetriche perchè la loro
	      %       lunghezza d'nda varia tra 1mm e 30mm, che sono molto più corte rispetto alle onde radio
	      %       tradizionalmente usate. Esse permetono velocità molto elevate e basssa latenza, ma hanno
	      %       una portata limitata e scarsa capacità di penetrazione, richiedendo infrastrutture dense
	      %       come small cells e tecnologie avanzate come il beamforming. Utilizzate insieme
	      %       a frequenze più basse per garantire una copertura completa,
	      %       le mmWave sono cruciali per migliorare la capacità delle
	      %       reti in aree ad alta densità di utenti.

	\item \textbf{\hypertarget{EAP-AKA}{EAP-AKA}}:
	      is an authentication protocol designed to enable secure authentication between a mobile device
	      and a network, based on the concept of symmetric keys. When a device wishes to connect to a network,
	      it sends an authentication request using a \texttt{SUCI}, an encrypted version of its permanent
	      identifier, the \texttt{SUPI}, allowing the network to identify the device without revealing
	      the user’s real identity and ensuring their privacy. Upon receiving the request, the network
	      uses the SUCI to access the credentials stored in the \texttt{ARPF} database, where the secret
	      key \texttt{K} is kept, shared between the device and the network. If the \texttt{EAP-AKA}
	      protocol is chosen, the network initiates the authentication process by generating a
	      \texttt{challenge} for the device consisting of three elements: a random number
	      \texttt{(RAND)}, an authentication message \texttt{(AUTN)}, and the expected response
	      \texttt{(XRES)}, which are sent to the device. The device verifies the \texttt{AUTN} value using
	      the key \texttt{K} in its \texttt{USIM}, and if the \texttt{AUTN} is valid, it calculates a
	      response \texttt{(RES)} based on \texttt{RAND} and the key \texttt{K}, then sends it to the network,
	      which compares the received \texttt{RES} with the previously generated \texttt{XRES}; if they match,
	      the authentication is successful and both parties have verified each other's identity.
	      ubsequently, the session key is generated, derived from the key \texttt{K} and the materials
	      generated in the challenge, with keys such as \texttt{CK} (for data encryption) and
	      \texttt{IK} (for message integrity), essential for protecting communications.
	      Once the authentication process is complete and the session keys are derived, the device and
	      the network can begin to exchange data securely, knowing that the communications are protected
	      by robust security measures.
	      % \item \textbf{\hypertarget{EAP-AKA}{EAP-AKA}}: è un protocollo di autenticazione progettato
	      %       per consentire l'autenticazione sicura tra un dispositivo mobile e una rete, basato
	      %       sul concetto di chiavi simmetriche. Quando un dispositivo, desidera connettersi a
	      %       una rete, invia una richiesta di autenticazione utilizzando un \texttt{SUCI},
	      %       una versione cifrata del suo identificatore permanente, il \texttt{SUPI}, consentendo
	      %       alla rete di identificare il dispositivo senza rivelare l’identità reale dell’utente
	      %       e garantendo la sua privacy. La rete, ricevuta la richiesta, utilizza il SUCI per
	      %       accedere alle credenziali memorizzate nel database dell’\texttt{ARPF}, dove è custodita
	      %       la chiave segreta \texttt{K}, condivisa tra il dispositivo e la rete; se viene scelto
	      %       il protocollo \texttt{EAP-AKA}, la rete avvia il processo di autenticazione generando
	      %       una \texttt{sfida} per il dispositivo composta da tre elementi: un numero casuale
	      %       \texttt{(RAND)}, un messaggio di autenticazione \texttt{(AUTN)} e la risposta attesa
	      %       \texttt{(XRES)}, che vengono inviati al dispositivo. Questo verifica il valore
	      %       \texttt{AUTN} utilizzando la chiave \texttt{K} nella sua \texttt{USIM}, e, se
	      %       l'\texttt{AUTN} è valido, calcola una risposta \texttt{(RES)} basata su \texttt{RAND}
	      %       e la chiave \texttt{K}, quindi la invia alla rete, che confronta la \texttt{RES}
	      %       ricevuta con la \texttt{XRES} generata in precedenza; se corrispondono,
	      %       l’autenticazione ha successo e entrambe le parti hanno verificato l'identità reciproca.
	      %       Successivamente, si genera la chiave di sessione, derivata dalla chiave \texttt{K}
	      %       e dai materiali generati nella sfida, con chiavi come \texttt{CK}
	      %       (per la cifratura dei dati) e \texttt{IK} (per l’integrità dei messaggi), essenziali
	      %       per proteggere le comunicazioni. Una volta completato il processo di autenticazione
	      %       e derivate le chiavi di sessione, il dispositivo e la rete possono iniziare a scambiare
	      %       dati in modo sicuro, sapendo che le comunicazioni sono protette
	      %       da solide misure di sicurezza.

	\item \textbf{\hypertarget{5G AKA}{5G AKA}}:
	      The \texttt{5G AKA} process begins with the device sending an authentication
	      request to the network via the \texttt{SUCI}, an encrypted version of the
	      \texttt{SUPI}, which protects the user's identity during registration.
	      The network receives this request and sends it to the credential database,
	      which contains the secret key \texttt{K} shared between the device and the network.
	      If the \texttt{5G AKA} protocol is chosen, the network generates a \texttt{challenge}
	      consisting of a random number \texttt{(RAND)}, a temporary authentication \texttt{(AUTN)},
	      and an expected response \texttt{(XRES)}, which are sent to the device. The device,
	      using the key \texttt{K} stored in the \texttt{USIM}, verifies the \texttt{AUTN} to
	      confirm the identity of the network; if the verification is valid, it calculates a
	      response \texttt{(RES)} based on \texttt{RAND} and \texttt{K}, which is then sent to
	      the network. The network compares the \texttt{RES} with the previously generated
	      \texttt{XRES}, and if they match, the authentication is successful.\@ At this point,
	      session keys for encryption and the integrity of communications are generated, ensuring
	      the security of transmitted data. An important feature of \texttt{5G AKA} is the
	      enhancement of user privacy, thanks to the separation of encryption and integrity
	      keys and more robust mechanisms to prevent tracking and identity correlation attacks,
	      significantly improving security compared to previous generations.\@
	      % \item \textbf{\hypertarget{5G AKA}{5G AKA}}: Il processo \texttt{5G AKA} inizia con l'invio,
	      %  da parte del dispositivo, di una richiesta di autenticazione alla rete tramite il \texttt{SUCI},
	      %  una versione cifrata del \texttt{SUPI}, che protegge l'identità dell'utente durante la registrazione.
	      %  La rete riceve questa richiesta e la invia al database delle credenziali,
	      %  che contiene la chiave segreta \texttt{K} condivisa tra il dispositivo e la rete.
	      %  Se viene scelto il protocollo \texttt{5G AKA}, la rete genera una \texttt{sfida}
	      %  composta da un numero casuale \texttt{(RAND)}, un'autenticazione temporanea \texttt{(AUTN)}
	      %  e una risposta attesa \texttt{(XRES)}, che vengono inviati al dispositivo.
	      %  Il dispositivo, usando la chiave \texttt{K} memorizzata nella \texttt{USIM},
	      %  verifica l'\texttt{AUTN} per confermare l'identità della rete;
	      %  se la verifica è valida, calcola una risposta \texttt{(RES)} basata su \texttt{RAND} e \texttt{K},
	      %  che viene poi inviata alla rete. La rete confronta la \texttt{RES} con la \texttt{XRES} generata in precedenza,
	      %  e se corrispondono, l'autenticazione ha successo.\@
	      %  A questo punto, vengono generate le chiavi di sessione per la cifratura
	      %  e l'integrità delle comunicazioni, garantendo la sicurezza dei dati trasmessi.
	      %  Una caratteristica importante del \texttt{5G AKA} è il rafforzamento della privacy dell'utente,
	      %  grazie alla separazione delle chiavi di cifratura e integrità e a meccanismi più robusti
	      %  per prevenire attacchi di tracciamento e correlazione delle identità,
	      %  migliorando significativamente la sicurezza rispetto alle generazioni precedenti.\@

	\item \textbf{\hypertarget{PLMN}{PLMN (Public Land Mobile Network)}}:
	      It is a public land mobile network. A PLMN is a mobile network that provides mobile
	      communication services to the public. Each mobile operator has its own PLMN identified
	      by a unique code, which allows devices to identify and connect to that network.
	      % \item \textbf{\hypertarget{PLMN}{PLMN (Public Land Mobile Network)}}:
	      %       È una rete mobile pubblica terrestre. Un PLMN è una rete mobile che fornisce servizi di
	      %       comunicazione mobile al pubblico. Ogni operatore mobile ha il proprio PLMN identificato
	      %       da un codice univoco, che consente ai dispositivi di identificare e connettersi a quella rete.

	\item \textbf{FBMC}\hypertarget{FBMC}{}:
	      The Filter Bank Multicarrier (FBMC) is a modulation
	      technique that divides a signal into multiple subchannels, applying filters to reduce
	      interference between them, thus improving spectral efficiency compared to OFDM.\@
	      % \item \textbf{FBMC}\hypertarget{FBMC}{}: Il Filter Bank Multicarrier (FBMC) è una tecnica di
	      % modulazione che divide un segnale in più sottocanali, applicando filtri per ridurre
	      % le interferenze tra questi, migliorando così l'efficienza spettrale rispetto all'OFDM.\@

	\item \textbf{FullDuplex}\hypertarget{FullDuplex}{}:
	      Full duplex is a mode of communication in which data can be transmitted and
	      received simultaneously between two devices or points. In other words,
	      both parties can send and receive information at the same time, without
	      having to wait for one of them to finish transmitting.
	      % \item \textbf{FullDuplex}\hypertarget{FullDuplex}{}:Il full duplex è una modalità di comunicazione
	      % in cui i dati possono essere trasmessi e ricevuti contemporaneamente tra due dispositivi
	      % o punti. In altre parole, entrambe le parti possono inviare e ricevere informazioni allo
	      % stesso tempo, senza dover aspettare che una delle due abbia finito di trasmettere.

	\item \textbf{Ultra Dense Networking}\hypertarget{UDN}{}:
	      Ultra Dense Networking (UDN) is a network architecture designed
	      to improve network capacity and coverage in high-density user or
	      device environments. UDN is based on the idea of increasing the
	      number of cells or small base stations (small cells) in a
	      geographic area, reducing the distance between these stations and
	      the connected devices. This reduces the load on each individual
	      base station, improving bandwidth capacity and signal quality.
	      % \item \textbf{Ultra Dense Networking}\hypertarget{UDN}{}:L'Ultra Dense Networking (UDN) è una
	      %       architettura di rete progettata per migliorare la capacità e la copertura della rete
	      %       in ambienti ad alta densità di utenti o dispositivi.DN si basa sull'idea di aumentare
	      %       il numero di celle o piccole stazioni base (small cells) in un'area geografica,
	      %       riducendo la distanza tra queste stazioni e i dispositivi connessi. Questo riduce il
	      %       carico su ogni singola stazione base, migliorando la capacità di banda e la qualità
	      %       del segnale.

	\item \textbf{\hypertarget{SDN}{Software-Defined Networking}}:
	      Software-Defined Networking (SDN) is an approach to network management that separates the control
	      plane from the data plane. Traditionally, routers and switches perform both the task of routing
	      traffic (data plane) and deciding how to do so (control plane). SDN moves the control plane to a
	      central software entity called a \texttt{controller}, which has a global view of the network and
	      can dynamically program how packets should be handled by the switches, simplifying network
	      management and enhancing its agility.
	      % \item \textbf{\hypertarget{SDN}{Software-Defined Networking}}: Software-Defined Networking (SDN)
	      %       è un approccio alla gestione delle reti che separa il piano di controllo (control plane)
	      %       dal piano dati (data plane). Tradizionalmente, i router e gli switch svolgono sia il
	      %       compito di instradare il traffico (piano dati) che di decidere come farlo
	      %       (piano di controllo). SDN sposta il piano di controllo in un'entità software centrale
	      %       chiamata \texttt{controller}, che ha una visione globale della rete e può programmare
	      %       dinamicamente come i pacchetti devono essere gestiti dagli switch, semplificando la
	      %       gestione della rete e migliorandone l'agilità.

	\item \textbf{\hypertarget{NFV}{Network Function Virtualization}}:
	      Network Function Virtualization (NFV) is a technology that virtualizes network functions,
	      such as firewalls, routers, load balancers, and other network devices, on standard servers,
	      eliminating the need for specialized hardware. NFV allows for the deployment and management
	      of network functions as software, enhancing scalability, speed of implementation, and reducing costs.
	      % \item \textbf{\hypertarget{NFV}{Network Function Virtualization}}: La Network Function
	      %       Virtualization (NFV) è una tecnologia che virtualizza le funzioni di rete, come firewall,
	      %       router, load balancer e altri dispositivi di rete, su server standard,
	      %       eliminando la necessità di hardware specializzato. NFV consente di distribuire e gestire
	      %       le funzioni di rete come software, migliorando la scalabilità, la velocità di
	      %       implementazione e riducendo i costi.

	\item \textbf{\hypertarget{S-TMSI}{S-TMSI}}:
	      It is a temporary identifier used in 4G LTE and 5G networks to represent a
	      subscriber without revealing their IMSI (International Mobile Subscriber Identity).
	      It is generated by the network and changes periodically, reducing the risk of
	      tracking and cyber attacks.
	      % \item \textbf{\hypertarget{S-TMSI}{S-TMSI}}: è un identificatore temporaneo
	      %       utilizzato nelle reti 4G LTE e 5G per rappresentare un abbonato senza rivelarne
	      %       l'IMSI (International Mobile Subscriber Identity).
	      %       Esso viene generato dalla rete e cambia periodicamente,
	      %       riducendo il rischio di tracciamento e attacchi informatici.

	\item \textbf{\hypertarget{RRC}{RRC}}:
	      The RRC protocol is a fundamental part of the mobile network architecture,
	      used to manage communication between the user terminal (UE) and the radio
	      network in the context of mobile technologies. RRC handles radio resource management,
	      ensuring that the terminal can access and utilize network resources efficiently.
	      The protocol performs several key functions, including: configuring and managing
	      radio connections, monitoring network conditions, managing transitions between different
	      operating modes (for example, from idle state to connected state), and allocating
	      the necessary resources for data transmission. During the handover process,
	      RRC ensures service continuity by transferring control of radio resources from
	      one cell to another as the user moves. RRC is divided into different operating modes:
	      RRC\_IDLE, in which the terminal is not actively connected to the network, and
	      RRC\_CONNECTED, where the terminal is in active communication with the network.
	      The protocol also plays an important role in ensuring the security of communications
	      by managing encryption and authentication keys.

	      % \item \textbf{\hypertarget{RRC}{RRC}}: Il protocollo RRC è una parte fondamentale
	      %       dell'architettura delle reti mobili, utilizzato per gestire la comunicazione
	      %       tra il terminale utente (UE) e la rete radio nel contesto delle tecnologie
	      %       mobili. RRC si occupa della gestione delle risorse radio,
	      %       garantendo che il terminale possa accedere e utilizzare le risorse di rete
	      %       in modo efficiente. Il protocollo svolge diverse funzioni chiave, tra cui:
	      %       la configurazione e la gestione delle connessioni radio,
	      %       il monitoraggio delle condizioni della rete, la gestione delle
	      %       transizioni tra le diverse modalità operative (ad esempio, da stato di
	      %       idle a stato connesso), e l'assegnazione delle risorse necessarie per la
	      %       trasmissione dei dati. Durante il processo di handover, RRC garantisce la
	      %       continuità del servizio, trasferendo il controllo delle risorse radio da una
	      %       cella all'altra quando l'utente si sposta. RRC si divide in diverse modalità
	      %       di funzionamento: RRC\_IDLE, in cui il terminale non è connesso attivamente alla
	      %       rete, e RRC\_CONNECTED, dove il terminale è in comunicazione attiva con la rete.
	      %       Il protocollo svolge anche un ruolo importante nel garantire la sicurezza
	      %       delle comunicazioni, gestendo le chiavi di cifratura e autenticazione.

	\item \textbf{\hypertarget{eNB}{eNB}}:
	      It represents the radio access node of \texttt{4G LTE} networks.\@
	      eNB is responsible for transmitting and receiving radio signals
	      between the end user and the \texttt{LTE} core network and has
	      functions for radio resource management, encoding and decoding,
	      power control, mobility management, and data scheduling.
	      % \item \textbf{eNB}\hypertarget{eNB}{}:
	      %       Rappresenta il  nodo di accesso radio delle reti
	      %       \texttt{4G LTE}.\@ eNB è responsabile della trasmissione
	      %       e ricezione dei segnali radio tra l'utente finale e la
	      %       rete core \texttt{LTE} e ha funzioni di gestione delle
	      %       risorse radio, codifica e decodifica, controllo di potenza,
	      %       gestione della mobilità e dellos cheduling dei dati.

	\item \textbf{\hypertarget{gNB}{gNB}}:
	      The gNB is the base station used in 5G networks and represents the evolution of the eNB
	      from LTE networks. It plays a crucial role in providing radio connectivity to user
	      equipment (UE) and manages communications between mobile devices and the 5G core network.
	      The gNB is designed to support higher capacity and lower latency, enabling advanced
	      services such as massive IoT (Internet of Things), augmented reality, and critical communications.
	      Unlike the eNB, the gNB can simultaneously handle multiple radio access modes, including
	      NR (New Radio), and supports both standalone (SA) and non-standalone (NSA) configurations.
	      The gNB communicates with the core network via the NG protocol, which includes interfaces
	      for signaling and data transport. One of the distinguishing features of the gNB is its
	      coordination capability with other gNBs to implement advanced techniques such as
	      Coordinated Multi-Point (CoMP), enhancing coverage and spectral efficiency.
	      Additionally, the gNB implements advanced security mechanisms, such as authentication and
	      encryption, to ensure secure and protected communications.
	      % \item \textbf{\hypertarget{gNB}{gNB}}:
	      %       Il gNB è la stazione base utilizzata nelle reti 5G
	      %       e rappresenta l'evoluzione dell'eNB delle reti LTE.
	      %       Svolge un ruolo fondamentale nel fornire connettività
	      %       radio ai terminali utente (UE) e gestisce le comunicazioni
	      %       tra il dispositivo mobile e il core network 5G.
	      %       Il gNB è progettato per supportare una maggiore capacità e una latenza ridotta,
	      %       consentendo così servizi avanzati come il massive IoT (Internet delle Cose),
	      %       la realtà aumentata e le comunicazioni critiche. A differenza dell'eNB,
	      %       il gNB può gestire simultaneamente diverse modalità di accesso radio,
	      %       inclusa la NR (New Radio), e supporta configurazioni sia standalone (SA)
	      %       che non standalone (NSA). Il gNB comunica con il core network tramite il
	      %       protocollo NG, che include interfacce per la segnalazione e il trasporto dei dati.
	      %       Una delle caratteristiche distintive del gNB è la sua capacità di coordinazione
	      %       con altri gNB per implementare tecniche avanzate come il
	      %       Coordinated Multi-Point (CoMP), migliorando la copertura e
	      %       l'efficienza spettrale. Inoltre,
	      %       il gNB implementa meccanismi di sicurezza avanzati,
	      %       come l'autenticazione e la cifratura, per garantire
	      %       comunicazioni sicure e protette.

	\item \hypertarget{IMSI}{\textbf{IMSI}}:
	      The International Mobile Subscriber Identity (IMSI) is a unique identification number,
	      consisting of 15 digits, associated with each subscriber in mobile networks.
	      This number is used to identify and authenticate a user within a mobile network.
	      The IMSI is stored in the SIM card and includes the Mobile Country Code (MCC),
	      the Mobile Network Code (MNC), and a subscriber identification number (MSIN).
	      % \item \hypertarget{IMSI}{\textbf{IMSI}}: International Mobile Subscriber Identity
	      %       è un numero identificativo univoco,
	      %       composto da 15 cifre associato a ciascun abbonato nella rete mobili.
	      %       Questo numero è utilizzato per identificare e autenticare un utente all'interno
	      %       di una rete mobile.\@ \texttt{IMSI} è memorizzato nella scheda SIM e include il
	      %       codice del paese \texttt{(MCC)},
	      %       il codice dell'operatore \texttt{(MNC)}
	      %       e un numero identificativo dell'abbbonato \texttt{(MSIN)}.

	\item \hypertarget{SDR}{SDR}:
	      A Software-Defined Radio (SDR) device is a radio where most of the signal processing operations,
	      such as modulation and demodulation, are performed via software instead of fixed hardware.
	      This allows the device to adapt to different frequencies and radio protocols simply by
	      updating the software, making it extremely flexible and versatile for applications such
	      as telecommunications, research, and security analysis.
	      % \item \hypertarget{SDR}{SDR}: Un dispositivo SDR (Software-Defined Radio)
	      %       è una radio in cui gran parte delle operazioni di elaborazione del segnale,
	      %       come modulazione e demodulazione, viene eseguita tramite software anziché hardware fisso.
	      %       Questo permette di adattare il dispositivo a diverse frequenze e protocolli radio
	      %       semplicemente aggiornando il software, rendendolo estremamente flessibile e versatile
	      %       per applicazioni come telecomunicazioni, ricerca e analisi di sicurezza.

	\item \hypertarget{RTP}{RTP}:
	      The RTP protocol is used for the transport of real-time multimedia data,
	      such as audio and video, over IP networks, and is essential for applications
	      like VoIP telephony and videoconferencing. RTP provides functionalities to
	      synchronize the multimedia stream and ensure the correct sequence of packets,
	      even when they traverse different network paths. During transmission,
	      multimedia data is encapsulated in RTP packets that include essential
	      information such as the timestamp (for stream synchronization) and the
	      sequence number (for packet ordering). The protocol is often used in
	      conjunction with RTCP (RTP Control Protocol), which monitors the quality
	      of service by providing feedback on delay, jitter, and packet loss.
	      RTP does not natively provide security features, so to ensure communication
	      protection, it can be used in combination with protocols like SRTP (Secure RTP),
	      which offers encryption and authentication. RTP is particularly suited for real-time
	      transmissions as it is optimized to minimize delays and maintain consistent quality
	      even over unreliable networks.
	      % \item \textbf{\hypertarget{RTP}{RTP}}: Il protocollo RTP è utilizzato per
	      %       il trasporto di dati multimediali in tempo reale, come audio e video,
	      %       su reti IP, ed è fondamentale per applicazioni come la telefonia VoIP e
	      %       le videoconferenze. RTP fornisce funzionalità per sincronizzare il
	      %       flusso multimediale e garantire la corretta sequenza dei pacchetti,
	      %       anche se viaggiano attraverso percorsi di rete diversi.
	      %       Durante la trasmissione, i dati multimediali vengono incapsulati in pacchetti
	      %       RTP che includono informazioni essenziali come il timestamp
	      %       (per la sincronizzazione del flusso) e il numero di sequenza
	      %       (per l'ordinamento dei pacchetti). Il protocollo è spesso utilizzato insieme
	      %       a RTCP (RTP Control Protocol), che monitora la qualità del servizio,
	      %       fornendo feedback sul ritardo, jitter e perdita di pacchetti.
	      %       RTP non fornisce nativamente funzionalità di sicurezza,
	      %       quindi per garantire la protezione delle comunicazioni,
	      %       può essere usato in combinazione con protocolli come
	      %       SRTP (Secure RTP), che offre cifratura e autenticazione.
	      %       RTP è particolarmente adatto per trasmissioni in tempo reale poiché
	      %       è ottimizzato per minimizzare i ritardi e mantenere una qualità
	      %       costante anche su reti non affidabili.

	\item \hypertarget{GTP}{GTP}:
	      GTP is a protocol used in mobile networks for the transport of data and signaling
	      between network nodes. It is divided into two main components:
	      \textbf{GTP-C} (Control Plane), which manages signaling and session control,
	      and \textbf{GTP-U} (User Plane), which handles the actual transport of user data.
	      When a user connects to the network, GTP-C creates a tunnel for signaling between
	      the core network nodes. Once the tunnel is established, GTP-U transports the user
	      data packets by encapsulating and sending them through the network. If the user
	      changes cells or the connection needs to be updated, GTP-C intervenes to modify
	      the session, ensuring continuity of data transmission. At the end of the session,
	      GTP-C closes the tunnel and terminates the connection. Although GTP is essential
	      for efficient data transport, it may present vulnerabilities that could be exploited
	      by attacks, necessitating the adoption of appropriate security measures.
	      % \item \textbf{\hypertarget{GTP}{GTP}}: Il GTP è un protocollo utilizzato
	      %       nelle reti mobili per il trasporto dei dati e la segnalazione tra nodi della rete.
	      %       Si divide in due componenti principali: il \textbf{GTP-C} (Control Plane),
	      %       che gestisce la segnalazione e il controllo delle sessioni, e il
	      %       \textbf{GTP-U} (User Plane), che si occupa del trasporto
	      %       effettivo dei dati dell'utente. Quando un utente si connette alla rete,
	      %       il GTP-C crea un tunnel per la segnalazione tra i nodi della rete core.
	      %       Una volta stabilito il tunnel, il GTP-U trasporta i pacchetti dati dell'utente
	      %       incapsulandoli e inviandoli attraverso la rete. Se l'utente cambia cella o la
	      %       connessione deve essere aggiornata, il GTP-C interviene per modificare la sessione,
	      %       garantendo la continuità della trasmissione dei dati. Al termine della sessione,
	      %       il GTP-C chiude il tunnel e termina la connessione. Anche se il GTP è essenziale
	      %       per il trasporto efficiente dei dati, può presentare vulnerabilità che potrebbero
	      %       essere sfruttate da attacchi, rendendo necessaria l'adozione di misure di
	      %       sicurezza appropriate.

	\item \hypertarget{NAS}{NAS}:
	      It manages the communication between the user's device and the core network,
	      handling authentication and registration to ensure that only authorized devices
	      access the network. Additionally, it deals with mobility, allowing users to move from
	      one cell to another without interruptions. It also manages data sessions, establishing
	      and terminating connections while maintaining the quality of service.
	      % \item \textbf{\hypertarget{NAS}{NAS}}: Gestisce la comunicazione tra il dispositivo dell'utente e il
	      %       core network, occupandosi di autenticazione e registrazione, assicurando che solo i dispositivi
	      %       autorizzati accedano alla rete. Inoltre, si occupa della mobilità, consentendo agli utenti di
	      %       passare da una cella all'altra senza interruzioni. Gestisce anche le sessioni di dati, stabilendo
	      %       e terminando le connessioni e mantenendo la qualità del servizio.

	\item \hypertarget{MME}{MME}:
	      The Mobility Management Entity (MME) is a software component in the core network of 4G
	      and 5G mobile networks, responsible for managing user mobility and signaling.
	      It performs key functions such as user authentication, session management, location tracking,
	      and routing service requests to other network entities. The MME communicates with terminal
	      devices and other network elements using protocols like NAS (Non Access Stratum) and GTP
	      (GPRS Tunneling Protocol).
	      % \item \textbf{\hypertarget{MME}{MME}}: L'Mobility Management Entity (MME) è un componente software nel
	      %       core network delle reti mobili 4G e 5G, responsabile della gestione della mobilità degli utenti
	      %       e della segnalazione. Svolge funzioni chiave come l'autenticazione degli utenti, la gestione
	      %       delle sessioni,
	      %       il monitoraggio della posizione e l'instradamento delle richieste di servizio verso
	      %       altre entità di rete. L'MME comunica con dispositivi terminali e altri elementi
	      %       della rete utilizzando protocolli come NAS (Non Access Stratum) e
	      %       GTP (GPRS Tunneling Protocol).
\end{itemize}
\clearpage
\printbibliography\end{document}
